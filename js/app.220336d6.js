(function(e){function t(t){for(var n,o,c=t[0],i=t[1],u=t[2],l=0,p=[];l<c.length;l++)o=c[l],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);d&&d(t);while(p.length)p.shift()();return s.push.apply(s,u||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,c=1;c<r.length;c++){var i=r[c];0!==a[i]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},a={app:0},s=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/UptaleDataAnalysis/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=i;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"063f":function(e,t,r){},1603:function(e,t,r){"use strict";r("ab01")},"19b0":function(e,t,r){},"221b":function(e,t,r){},2334:function(e,t,r){"use strict";r("48f6")},"332b":function(e,t,r){},"3aed":function(e,t,r){},"3c1a":function(e,t,r){"use strict";r("f432")},"451f":function(e,t,r){"use strict";r("4ea0")},"48f6":function(e,t,r){},4905:function(e,t,r){"use strict";r("e2b3")},"4ea0":function(e,t,r){},5261:function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("7a23"),a=r("1da1"),s=(r("96cf"),r("5502")),o=r("d4ec"),c=r("bee2"),i=r("ade3"),u=(r("d3b7"),function(){function e(t){var r=this;Object(o["a"])(this,e),Object(i["a"])(this,"worker",void 0),Object(i["a"])(this,"_queue",[]),Object(i["a"])(this,"id",0),this.worker=t,this.worker.onmessage=function(e){"progress"==e.data.type?r.onProgress(e.data):(r._queue[e.data.id].resolve(e.data),delete r._queue[e.data.id])},this.worker.onerror=function(e){r._queue[e.data.id].reject(e.data),delete r._queue[e.data.id]}}return Object(c["a"])(e,[{key:"send",value:function(e){var t=this;if(null==e.id)throw"Data sent to worker does not contains an ID";if(this._queue[e.id])throw"Duplicate ID in data sent to worker";var r=new Promise((function(r,n){t.worker.postMessage(e),t._queue[e.id]={resolve:r,reject:n}}));return r}}]),e}());r("ddb0"),r("159b"),r("b0c0"),r("07ac");function d(e){return(null===e||void 0===e?void 0:e.values.reduce((function(t,r){var n={};return r.forEach((function(t,r){n[e.columns[r]]=t})),t.push(n),t}),[]))||[]}function l(e,t,r){return p.apply(this,arguments)}function p(){return p=Object(a["a"])(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.send({id:t.id++,action:"exec",sql:r,params:n});case 2:return a=e.sent,a=a&&a.results?a.results[0]:null,e.abrupt("return",d(a));case 5:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function f(e){return b.apply(this,arguments)}function b(){return b=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,'SELECT \n            Scenes.Id, \n            Scenes.Name, \n            Categories.Id AS "CategoryId",\n            Categories.Name AS "CategoryName", \n            Categories.Color AS "CategoryColor",\n            Themes.Id AS "ThemeId", \n            Themes.Name AS "ThemeName", \n            Themes.Color AS "ThemeColor" \n        FROM Scenes \n        LEFT JOIN Categories \n            ON Categories.Id = Scenes.CategoryId \n        LEFT JOIN Themes \n            ON Themes.Id = Scenes.ThemeId'));case 1:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function m(e){return O.apply(this,arguments)}function O(){return O=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"SELECT Id, Name, Color FROM Categories"));case 1:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}function h(e,t){return g.apply(this,arguments)}function g(){return g=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"INSERT INTO Categories (Name, Color) VALUES ($name, $color)",{$name:r.name,$color:r.color}));case 1:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function j(e,t){return y.apply(this,arguments)}function y(){return y=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"UPDATE Categories SET Color = $color WHERE Id = $id",{$id:r.id,$color:r.color}));case 1:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function v(e,t){return I.apply(this,arguments)}function I(){return I=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"DELETE FROM Categories WHERE Id = $id",{$id:r.id}));case 1:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function k(e){return S.apply(this,arguments)}function S(){return S=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"SELECT Id, Name, Color FROM Themes"));case 1:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function U(e,t){return N.apply(this,arguments)}function N(){return N=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"INSERT INTO Themes (Name, Color) VALUES ($name, $color);",{$name:r.name,$color:r.color}));case 1:case"end":return e.stop()}}),e)}))),N.apply(this,arguments)}function w(e,t){return D.apply(this,arguments)}function D(){return D=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"UPDATE Themes SET Color = $color WHERE Id = $id",{$id:r.id,$color:r.color}));case 1:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}function E(e,t){return C.apply(this,arguments)}function C(){return C=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"DELETE FROM Themes WHERE Id = $id",{$id:r.id}));case 1:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function T(e,t){return x.apply(this,arguments)}function x(){return x=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"UPDATE Scenes SET CategoryId = $categoryId, ThemeId = $themeId WHERE Id = $id",{$id:r.sceneId,$categoryId:r.categoryId,$themeId:r.themeId}));case 1:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function R(e){return G.apply(this,arguments)}function G(){return G=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l(t,'SELECT \n    Users.Id AS "UserId",\n    Users.Name AS "UserName",\n    UsersGroups.Id AS "UserGroupId",\n    UsersGroups.Name AS "UserGroupName",\n    UsersGroups.Color AS "UserGroupColor",\n    UsersGroups.Type AS "UserGroupType"\n  FROM Users\n  LEFT JOIN UserGroupAssociation ON UserGroupAssociation.UserId = Users.Id\n  LEFT JOIN UsersGroups ON UsersGroups.Id = UserGroupAssociation.UserGroupId;');case 2:return r=e.sent,r=Object.values(r.reduce((function(e,t){return e[t.UserId]||(e[t.UserId]={Id:t.UserId,Name:t.UserName,Groups:[]}),e[t.UserId].Groups.push({Id:t.UserGroupId,Name:t.UserGroupName,Type:t.UserGroupType,Color:t.UserGroupColor}),e}),{})),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),G.apply(this,arguments)}function A(e){return L.apply(this,arguments)}function L(){return L=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l(t,'SELECT \n    Sessions.Id AS "SessionId",\n    Sessions.StartTime AS "SessionStart",\n    Sessions.EndTime AS "SessionEnd",\n      Users.Id AS "UserId",\n      Users.Name AS "UserName",\n      UsersGroups.Id AS "UserGroupId",\n      UsersGroups.Name AS "UserGroupName",\n      UsersGroups.Color AS "UserGroupColor",\n      UsersGroups.Type AS "UserGroupType"\n    FROM Users\n    LEFT JOIN UserGroupAssociation ON UserGroupAssociation.UserId = Users.Id\n    LEFT JOIN UsersGroups ON UsersGroups.Id = UserGroupAssociation.UserGroupId\n    LEFT JOIN Sessions ON Sessions.UserId = Users.Id;');case 2:return r=e.sent,r=Object.values(r.reduce((function(e,t){return e[t.SessionId]||(e[t.SessionId]={Id:t.SessionId,StartTime:t.SessionStart,EndTime:t.SessionEnd,Name:t.UserName,User:t.UserId,Groups:[]}),t.UserGroupId&&e[t.SessionId].Groups.push({Id:t.UserGroupId,Name:t.UserGroupName,Type:t.UserGroupType,Color:t.UserGroupColor}),e}),{})),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),L.apply(this,arguments)}function $(e){return _.apply(this,arguments)}function _(){return _=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"SELECT Id, Name, Color, Type FROM UsersGroups"));case 1:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}function M(e,t){return W.apply(this,arguments)}function W(){return W=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"INSERT INTO UsersGroups (Name, Color) VALUES ($name, $color)",{$name:r.name,$color:r.color}));case 1:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}function P(e,t){return F.apply(this,arguments)}function F(){return F=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"UPDATE UsersGroups SET Color = $color WHERE Id = $id",{$id:r.id,$color:r.color}));case 1:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}function H(e,t){return V.apply(this,arguments)}function V(){return V=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"DELETE FROM UsersGroups WHERE Id = $id",{$id:r.id}));case 1:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}function q(e,t){return z.apply(this,arguments)}function z(){return z=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"UPDATE Users SET UserGroupId = $userGroupId WHERE Id = $id",{$id:r.id,$userGroupId:r.userGroupId}));case 1:case"end":return e.stop()}}),e)}))),z.apply(this,arguments)}function J(e,t){return B.apply(this,arguments)}function B(){return B=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"INSERT INTO UserGroupAssociation (UserId, UserGroupId) VALUES ($UserId, $UserGroupId)",{$UserId:r.UserId,$UserGroupId:r.UserGroupId}));case 1:case"end":return e.stop()}}),e)}))),B.apply(this,arguments)}function Q(e,t){return Y.apply(this,arguments)}function Y(){return Y=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"DELETE FROM UserGroupAssociation WHERE UserId = $UserId AND UserGroupId = $UserGroupId",{$UserId:r.UserId,$UserGroupId:r.UserGroupId}));case 1:case"end":return e.stop()}}),e)}))),Y.apply(this,arguments)}function K(e,t){return X.apply(this,arguments)}function X(){return X=Object(a["a"])(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.send({id:t.id++,action:"exec",sql:r});case 2:if(n=e.sent,!n.error){e.next=5;break}throw n.error;case 5:return console.log("output",n.results[0].columns),console.table(n.results[0].values),n=n&&n.results?n.results[0]:null,e.abrupt("return",{data:n,dataObject:d(n)});case 9:case"end":return e.stop()}}),e)}))),X.apply(this,arguments)}var Z=new u(new Worker("scripts/workers/database.js")),ee=Object(s["a"])({state:function(){return{scenes:[],categories:[],themes:[],users:[],usersGroups:[],sessions:[],progress:{progress:0,message:""},isLoading:0,sqlWorker:Z}},mutations:{setData:function(e,t){var r=t.key,n=t.value;e[r]=n},incrementWorkerId:function(e){return e.sqlWorker.id++}},actions:{computeData:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=e.commit,e.state,n("setData",{key:"IsLoading",value:0}),!t.database){r.next=7;break}return r.next=5,Z.send({id:Z.id++,action:"open",buffer:t.database});case 5:r.next=11;break;case 7:return r.next=9,Z.send({id:Z.id++,action:"open"});case 9:return r.next=11,Z.send({id:Z.id++,action:"extractCSVData",files:t});case 11:return r.t0=n,r.next=14,f(Z);case 14:return r.t1=r.sent,r.t2={key:"scenes",value:r.t1},(0,r.t0)("setData",r.t2),r.t3=n,r.next=20,m(Z);case 20:return r.t4=r.sent,r.t5={key:"categories",value:r.t4},(0,r.t3)("setData",r.t5),r.t6=n,r.next=26,k(Z);case 26:return r.t7=r.sent,r.t8={key:"themes",value:r.t7},(0,r.t6)("setData",r.t8),r.t9=n,r.next=32,R(Z);case 32:return r.t10=r.sent,r.t11={key:"users",value:r.t10},(0,r.t9)("setData",r.t11),r.t12=n,r.next=38,$(Z);case 38:return r.t13=r.sent,r.t14={key:"usersGroups",value:r.t13},(0,r.t12)("setData",r.t14),r.t15=n,r.next=44,A(Z);case 44:r.t16=r.sent,r.t17={key:"sessions",value:r.t16},(0,r.t15)("setData",r.t17),n("setData",{key:"IsLoading",value:2}),n("setData",{key:"IsLoading",value:0});case 49:case"end":return r.stop()}}),r)})))()},addCategory:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,h(Z,t);case 4:return r.t0=n,r.next=7,m(Z);case 7:r.t1=r.sent,r.t2={key:"categories",value:r.t1},(0,r.t0)("setData",r.t2),n("setData",{key:"IsLoading",value:0});case 11:case"end":return r.stop()}}),r)})))()},addTheme:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,U(Z,t);case 4:return r.t0=n,r.next=7,k(Z);case 7:r.t1=r.sent,r.t2={key:"themes",value:r.t1},(0,r.t0)("setData",r.t2),n("setData",{key:"IsLoading",value:0});case 11:case"end":return r.stop()}}),r)})))()},addUserGroup:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,M(Z,t);case 4:return r.t0=n,r.next=7,$(Z);case 7:r.t1=r.sent,r.t2={key:"usersGroups",value:r.t1},(0,r.t0)("setData",r.t2),n("setData",{key:"IsLoading",value:0});case 11:case"end":return r.stop()}}),r)})))()},addUserGroupAssociation:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,J(Z,t);case 4:return r.t0=n,r.next=7,R(Z);case 7:r.t1=r.sent,r.t2={key:"users",value:r.t1},(0,r.t0)("setData",r.t2),n("setData",{key:"IsLoading",value:0});case 11:case"end":return r.stop()}}),r)})))()},updateCategory:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,j(Z,t);case 4:return r.t0=n,r.next=7,m(Z);case 7:return r.t1=r.sent,r.t2={key:"categories",value:r.t1},(0,r.t0)("setData",r.t2),r.t3=n,r.next=13,f(Z);case 13:r.t4=r.sent,r.t5={key:"scenes",value:r.t4},(0,r.t3)("setData",r.t5),n("setData",{key:"IsLoading",value:0});case 17:case"end":return r.stop()}}),r)})))()},updateTheme:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,w(Z,t);case 4:return r.t0=n,r.next=7,k(Z);case 7:return r.t1=r.sent,r.t2={key:"themes",value:r.t1},(0,r.t0)("setData",r.t2),r.t3=n,r.next=13,f(Z);case 13:r.t4=r.sent,r.t5={key:"scenes",value:r.t4},(0,r.t3)("setData",r.t5),n("setData",{key:"IsLoading",value:0});case 17:case"end":return r.stop()}}),r)})))()},updateScene:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,T(Z,t);case 4:return r.t0=n,r.next=7,f(Z);case 7:r.t1=r.sent,r.t2={key:"scenes",value:r.t1},(0,r.t0)("setData",r.t2),n("setData",{key:"IsLoading",value:0});case 11:case"end":return r.stop()}}),r)})))()},updateUserGroup:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,P(Z,t);case 4:return r.t0=n,r.next=7,$(Z);case 7:return r.t1=r.sent,r.t2={key:"usersGroups",value:r.t1},(0,r.t0)("setData",r.t2),r.t3=n,r.next=13,R(Z);case 13:return r.t4=r.sent,r.t5={key:"users",value:r.t4},(0,r.t3)("setData",r.t5),r.t6=n,r.next=19,A(Z);case 19:r.t7=r.sent,r.t8={key:"sessions",value:r.t7},(0,r.t6)("setData",r.t8),n("setData",{key:"IsLoading",value:0});case 23:case"end":return r.stop()}}),r)})))()},updateUser:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,q(Z,t);case 4:return r.t0=n,r.next=7,R(Z);case 7:return r.t1=r.sent,r.t2={key:"users",value:r.t1},(0,r.t0)("setData",r.t2),r.t3=n,r.next=13,A(Z);case 13:r.t4=r.sent,r.t5={key:"sessions",value:r.t4},(0,r.t3)("setData",r.t5),n("setData",{key:"IsLoading",value:0});case 17:case"end":return r.stop()}}),r)})))()},deleteUserGroup:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,H(Z,t);case 4:return r.t0=n,r.next=7,$(Z);case 7:return r.t1=r.sent,r.t2={key:"usersGroups",value:r.t1},(0,r.t0)("setData",r.t2),r.t3=n,r.next=13,R(Z);case 13:return r.t4=r.sent,r.t5={key:"users",value:r.t4},(0,r.t3)("setData",r.t5),r.t6=n,r.next=19,A(Z);case 19:r.t7=r.sent,r.t8={key:"sessions",value:r.t7},(0,r.t6)("setData",r.t8),n("setData",{key:"IsLoading",value:0});case 23:case"end":return r.stop()}}),r)})))()},deleteCategory:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,v(Z,t);case 4:return r.t0=n,r.next=7,f(Z);case 7:return r.t1=r.sent,r.t2={key:"scenes",value:r.t1},(0,r.t0)("setData",r.t2),r.t3=n,r.next=13,m(Z);case 13:r.t4=r.sent,r.t5={key:"categories",value:r.t4},(0,r.t3)("setData",r.t5),n("setData",{key:"IsLoading",value:0});case 17:case"end":return r.stop()}}),r)})))()},deleteTheme:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,E(Z,t);case 4:return r.t0=n,r.next=7,f(Z);case 7:return r.t1=r.sent,r.t2={key:"scenes",value:r.t1},(0,r.t0)("setData",r.t2),r.t3=n,r.next=13,k(Z);case 13:r.t4=r.sent,r.t5={key:"themes",value:r.t4},(0,r.t3)("setData",r.t5),n("setData",{key:"IsLoading",value:0});case 17:case"end":return r.stop()}}),r)})))()},deleteUserGroupAssociation:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,e.state,n("setData",{key:"IsLoading",value:1}),r.next=4,Q(Z,t);case 4:return r.t0=n,r.next=7,R(Z);case 7:return r.t1=r.sent,r.t2={key:"users",value:r.t1},(0,r.t0)("setData",r.t2),r.t3=n,r.next=13,A(Z);case 13:r.t4=r.sent,r.t5={key:"sessions",value:r.t4},(0,r.t3)("setData",r.t5),n("setData",{key:"IsLoading",value:0});case 17:case"end":return r.stop()}}),r)})))()}}});Z.onProgress=function(e){ee.commit("setData",{key:"progress",value:0})};var te=["href"],re={key:0},ne={key:1,id:"container"},ae={key:2},se=["hidden"];function oe(e,t,r,a,s,o){var c=Object(n["u"])("Sidebar"),i=Object(n["u"])("Header"),u=Object(n["u"])("SceneList"),d=Object(n["u"])("UsersSetup"),l=Object(n["u"])("Analysis"),p=Object(n["u"])("SQLPlayground");return Object(n["n"])(),Object(n["g"])(n["a"],null,[Object(n["j"])(c,{onSidebar_click:o.sidebarManager},null,8,["onSidebar_click"]),Object(n["h"])("a",{id:"download",display:"none",href:s.serializedDatabaseURL,download:"database.db"},null,8,te),Object(n["h"])("div",{id:"nav",style:Object(n["m"])({"margin-left":a.sidebarWidth})},[Object(n["j"])(i,{id:"Header",title:"",onDownloadDatabase:o.downloadDatabase},null,8,["onDownloadDatabase"]),"categories"==s.display?(Object(n["n"])(),Object(n["g"])("div",re,[Object(n["j"])(u)])):Object(n["f"])("",!0),"Users"==s.display?(Object(n["n"])(),Object(n["g"])("div",ne,[Object(n["j"])(d)])):Object(n["f"])("",!0),"Analysis"==s.display?(Object(n["n"])(),Object(n["g"])("div",ae,[Object(n["j"])(l)])):Object(n["f"])("",!0),Object(n["h"])("div",{id:"container",hidden:!("SQL"==s.display)},[Object(n["j"])(p)],8,se)],4)],64)}r("3ca3"),r("2b3d"),r("9861");var ce=function(e){return Object(n["p"])("data-v-24b045ad"),e=e(),Object(n["o"])(),e},ie=ce((function(){return Object(n["h"])("input",{id:"categoryName",type:"text",placeholder:"add category"},null,-1)})),ue=[ie],de=ce((function(){return Object(n["h"])("input",{id:"themeName",type:"text",placeholder:"add theme"},null,-1)})),le=[de],pe={id:"sceneList"},fe={id:"categoryList"},be={class:"sticky"},me={id:"themeList"},Oe={class:"sticky"};function he(e,t,r,a,s,o){var c=Object(n["u"])("Scene"),i=Object(n["u"])("SceneProperty");return Object(n["n"])(),Object(n["g"])(n["a"],null,[Object(n["h"])("form",{onSubmit:t[0]||(t[0]=function(){return o.addCategory&&o.addCategory.apply(o,arguments)})},ue,32),Object(n["h"])("form",{onSubmit:t[1]||(t[1]=function(){return o.addTheme&&o.addTheme.apply(o,arguments)})},le,32),Object(n["h"])("div",pe,[(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(o.scenes,(function(e){return Object(n["n"])(),Object(n["e"])(c,{key:e.Id,scene:e,onUpdateScene:o.updateScene},null,8,["scene","onUpdateScene"])})),128)),Object(n["h"])("div",fe,[Object(n["h"])("div",be,[(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(o.categories,(function(e){return Object(n["n"])(),Object(n["e"])(i,{key:e.Id,id:e.Id,name:e.Name,color:e.Color,persistent:!0,type:"category",onDeleteProperty:o.deleteCategory,onUpdateProperty:o.updateCategory},null,8,["id","name","color","onDeleteProperty","onUpdateProperty"])})),128))])]),Object(n["h"])("div",me,[Object(n["h"])("div",Oe,[(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(o.themes,(function(e){return Object(n["n"])(),Object(n["e"])(i,{key:e.Id,id:e.Id,name:e.Name,color:e.Color,persistent:!0,type:"theme",onDeleteProperty:o.deleteTheme,onUpdateProperty:o.updateTheme},null,8,["id","name","color","onDeleteProperty","onUpdateProperty"])})),128))])])])],64)}function ge(e,t,r,a,s,o){var c=Object(n["u"])("SceneProperty");return Object(n["n"])(),Object(n["g"])("div",{class:"scene",onDragenter:t[0]||(t[0]=function(){return o.dragEnter&&o.dragEnter.apply(o,arguments)}),onDragleave:t[1]||(t[1]=function(){return o.dragLeave&&o.dragLeave.apply(o,arguments)}),onDragover:t[2]||(t[2]=function(){return o.dragOver&&o.dragOver.apply(o,arguments)}),onDrop:t[3]||(t[3]=function(){return o.drop&&o.drop.apply(o,arguments)}),style:Object(n["m"])({border:"1px solid "+s.border_color})},[Object(n["h"])("span",null,Object(n["v"])(r.scene.Name),1),Object(n["j"])(c,{id:r.scene.CategoryId,name:r.scene.CategoryName,color:r.scene.CategoryColor,type:"category",border:s.borders.category},null,8,["id","name","color","border"]),Object(n["j"])(c,{id:r.scene.ThemeId,name:r.scene.ThemeName,color:r.scene.ThemeColor,type:"theme",border:s.borders.theme},null,8,["id","name","color","border"])],36)}var je=["draggable"],ye={class:"propertyName"},ve=["value"];function Ie(e,t,r,a,s,o){return Object(n["n"])(),Object(n["g"])("span",{class:Object(n["l"])(["container",r.persistent?"persistent":null]),onDragstart:t[2]||(t[2]=function(){return o.dragStart&&o.dragStart.apply(o,arguments)}),onDragend:t[3]||(t[3]=function(){return o.dragEnd&&o.dragEnd.apply(o,arguments)}),style:Object(n["m"])({background:r.color,opacity:s.opacity,border:r.border}),draggable:!!this.persistent},[Object(n["h"])("span",ye,Object(n["v"])(r.name),1),r.persistent?(Object(n["n"])(),Object(n["g"])("input",{key:0,type:"color",value:r.color,onChange:t[0]||(t[0]=function(){return o.colorchange&&o.colorchange.apply(o,arguments)})},null,40,ve)):Object(n["f"])("",!0),r.persistent?(Object(n["n"])(),Object(n["g"])("button",{key:1,onClick:t[1]||(t[1]=function(){return o.deleteProperty&&o.deleteProperty.apply(o,arguments)})},"Delete")):Object(n["f"])("",!0)],46,je)}var ke={name:"SceneProperty",data:function(){return{opacity:1}},emits:["deleteProperty","updateProperty"],props:{id:"",color:"",name:"",persistent:{type:Boolean,default:!1},type:{type:String,default:"category"},border:{type:String,default:""}},methods:{dragStart:function(e){e.dropEffect="move",e.dataTransfer.effectAllowed=this.persistent?"copy":"move",e.dataTransfer.setData("Id",this.id),e.dataTransfer.setData("type",this.type),this.opacity=.5},dragEnd:function(){this.opacity=1},colorchange:function(e){this.$emit("updateProperty",{color:e.srcElement.value,id:this.id})},deleteProperty:function(){this.$emit("deleteProperty",{id:this.id})}}},Se=(r("b869"),r("d959")),Ue=r.n(Se);const Ne=Ue()(ke,[["render",Ie],["__scopeId","data-v-46de3cf3"]]);var we=Ne,De={name:"Scene",emits:["updateScene"],components:{SceneProperty:we},data:function(){return{border_color:"transparent",borders:{category:null,theme:null}}},props:{scene:{type:Object}},methods:{dragEnter:function(e){e.preventDefault()},dragLeave:function(e){this.border_color="transparent",this.borders[e.dataTransfer.getData("type")]=null},dragOver:function(e){e.preventDefault(),this.border_color="black",this.borders[e.dataTransfer.getData("type")]="2px solid red"},drop:function(e){e.preventDefault(),this.border_color="transparent",this.borders[e.dataTransfer.getData("type")]=null,"theme"==e.dataTransfer.getData("type")?this.scene.ThemeId=e.dataTransfer.getData("Id"):"category"==e.dataTransfer.getData("type")&&(this.scene.CategoryId=e.dataTransfer.getData("Id")),this.$emit("updateScene",{sceneId:this.scene.Id,categoryId:this.scene.CategoryId,themeId:this.scene.ThemeId})}}};r("93a8");const Ee=Ue()(De,[["render",ge],["__scopeId","data-v-f86c4c40"]]);var Ce=Ee,Te={name:"SceneList",components:{Scene:Ce,SceneProperty:we},computed:{scenes:function(){return this.$store.state.scenes},categories:function(){return this.$store.state.categories},themes:function(){return this.$store.state.themes}},methods:{addCategory:function(e){e.preventDefault(),this.$store.dispatch("addCategory",{name:e.srcElement.querySelector("#categoryName").value,color:"#ffffff"})},addTheme:function(e){e.preventDefault(),this.$store.dispatch("addTheme",{name:e.srcElement.querySelector("#themeName").value,color:"#ffffff"})},updateCategory:function(e){this.$store.dispatch("updateCategory",e)},updateTheme:function(e){this.$store.dispatch("updateTheme",e)},updateScene:function(e){this.$store.dispatch("updateScene",e)},deleteCategory:function(e){this.$store.dispatch("deleteCategory",e)},deleteTheme:function(e){this.$store.dispatch("deleteTheme",e)}}};r("dc8a");const xe=Ue()(Te,[["render",he],["__scopeId","data-v-24b045ad"]]);var Re=xe,Ge={id:"area",ref:"area",autonomplete:"on",autocorrect:"off",spellcheck:"off"},Ae=["href"];function Le(e,t,r,a,s,o){var c=Object(n["u"])("ViewTable");return Object(n["n"])(),Object(n["g"])(n["a"],null,[Object(n["h"])("textarea",Ge,null,512),s.downloadDataURL?(Object(n["n"])(),Object(n["g"])("a",{key:0,href:s.downloadDataURL,download:"result.csv"},"Download Results",8,Ae)):Object(n["f"])("",!0),Object(n["j"])(c,{data:{columns:s.data.columns,values:s.reducedValues}},null,8,["data"])],64)}var $e=r("2909"),_e=(r("a434"),r("99af"),r("4ec9"),r("d81d"),r("ac1f"),r("1276"),r("7db0"),r("2ca0"),function(e){var t=[];return e.forEach((function(e,r){e.id=r,t.push(e)})),t}),Me=function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))},We=(r("4e82"),["onClick"]);function Pe(e,t,r,a,s,o){return Object(n["n"])(),Object(n["g"])("table",null,[Object(n["i"])(Object(n["v"])(r.title)+" ",1),Object(n["h"])("tr",null,[(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(r.data.columns,(function(e,t){return Object(n["n"])(),Object(n["g"])("th",{key:e,onClick:function(r){return o.sort(e,t)}},Object(n["v"])(e+(s.sortIndex==t?s.sortDirection?"▲":"▼":" ")),9,We)})),128))]),(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(o.sortedValues,(function(e,t){return Object(n["n"])(),Object(n["g"])("tr",{key:e},[(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(e,(function(e,a){return Object(n["n"])(),Object(n["g"])("td",{key:e,style:Object(n["m"])(r.compare?{background:o.gradientSortedValues[t][a]}:null)},Object(n["v"])(e),5)})),128))])})),128))])}var Fe={name:"ViewTable",components:{},data:function(){return{sortIndex:0,sortDirection:!1}},computed:{sortedValues:function(){var e=this;return this.data.values.sort((function(t,r){var n=t[e.sortIndex],a=r[e.sortIndex],s=0;return n<a&&(s=-1),n>a&&(s=1),e.sortDirection&&(s*=-1),s}))},gradientSortedValues:function(){var e,t=this,r=[];return null===(e=this.compare)||void 0===e||e.forEach((function(e){var n=t.data.columns.indexOf(e.sorter),a=e.keys.map((function(e){return t.data.columns.indexOf(e.name)}));t.sortedValues.forEach((function(s,o){r[o]||(r[o]=[]);var c=Math.max.apply(Math,Object($e["a"])(t.sortedValues.map((function(e){return Math.abs(e[a[0]]-e[a[1]])})))),i=(s[a[0]]-s[a[1]])/c;r[o][n]=i>0?"linear-gradient(90deg, #ffffff ".concat(50-50*i,"%, ").concat(e.keys[0].color," ").concat(50-50*i,"%,  ").concat(e.keys[0].color," 50%,  #ffffff 50%)"):"linear-gradient(90deg, #ffffff 50%, ".concat(e.keys[1].color," 50%,").concat(e.keys[1].color," ").concat(50-50*i,"%,\n            #ffffff ").concat(50-50*i,"%\n            )")}))})),r}},props:{title:null,data:{columns:[],values:[]},compare:Array},methods:{sort:function(e,t){this.sortIndex==t?this.sortDirection=!this.sortDirection:(this.sortIndex=t,this.sortDirection=!1)}}};r("8a3c");const He=Ue()(Fe,[["render",Pe],["__scopeId","data-v-6a663299"]]);var Ve=He,qe={name:"SQLPlayground",emits:["SQLRequest","progress"],components:{ViewTable:Ve},data:function(){return{data:{columns:[],values:[]},dataObject:{},downloadDataURL:null,reducedValues:[],reducedInterval:0,codeMirror:null}},watch:{dataObject:function(){URL.revokeObjectURL(this.downloadDataURL),this.downloadDataURL=URL.createObjectURL(new Blob([d3.csvFormat(this.dataObject)],{type:"text/csv"}))},data:function(){this.showData()}},props:{columns:Array,values:Array},mounted:function(){var e;this.codeMirror=CodeMirror.fromTextArea(this.$refs.area,(e={lineNumbers:!0,mode:"text/x-mysql",viewportMargin:1/0,indentWithTabs:!0,smartIndent:!0},Object(i["a"])(e,"lineNumbers",!0),Object(i["a"])(e,"matchBrackets",!0),Object(i["a"])(e,"autofocus",!0),Object(i["a"])(e,"extraKeys",{"Ctrl-Enter":this.execEditorContents}),e))},methods:{execEditorContents:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,K(e.$store.state.sqlWorker,e.codeMirror.getValue()+";");case 2:r=t.sent,e.data=r.data,e.dataObject=r.dataObject;case 5:case"end":return t.stop()}}),t)})))()},showData:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return clearInterval(e.reducedInterval),e.$store.commit("setData",{key:"progress",value:{progress:100}}),r=15,n=25,t.next=6,Me(r);case 6:e.reducedValues=[],a=Object($e["a"])(e.data.values),s=e.data.values.length,o=0,e.reducedInterval=setInterval((function(){var t=a.splice(n);e.reducedValues=[].concat(Object($e["a"])(e.reducedValues),Object($e["a"])(a)),a=t,o=e.reducedValues.length,e.$store.commit("setData",{key:"progress",value:{progress:100*o/s,message:"Displaying results\n".concat(o,"/").concat(s,"\nCSV ready")}}),0==a.length&&clearInterval(e.reducedInterval)}),r);case 11:case"end":return t.stop()}}),t)})))()}}};r("a869"),r("c4dd");const ze=Ue()(qe,[["render",Le],["__scopeId","data-v-4b63d529"]]);var Je=ze,Be=function(e){return Object(n["p"])("data-v-2a13370a"),e=e(),Object(n["o"])(),e},Qe=Object(n["i"])(" Visite des Scenes "),Ye=Be((function(){return Object(n["h"])("th",null,"Focus",-1)})),Ke=["onChange"];function Xe(e,t,r,a,s,o){var c=Object(n["u"])("ViewTable");return Object(n["n"])(),Object(n["g"])(n["a"],null,[Object(n["h"])("table",null,[Qe,Object(n["h"])("tr",null,[Ye,(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(s.columns,(function(e){return Object(n["n"])(),Object(n["g"])("th",{key:e},Object(n["v"])(e),1)})),128))]),(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(s.values,(function(e){return Object(n["n"])(),Object(n["g"])("tr",{key:e},[Object(n["h"])("td",null,[Object(n["h"])("input",{type:"checkbox",name:"focus",onChange:function(t){return o.changeSceneFocus(e[0],t)}},null,40,Ke)]),(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(e,(function(e){return Object(n["n"])(),Object(n["g"])("td",{key:e},Object(n["v"])(e),1)})),128))])})),128))]),Object(n["j"])(c,{title:"Clicks sur les tags",data:{columns:s.specificColumns,values:s.specificValues},compare:[{keys:[{name:"M1 Clicks",color:"#e6b122"},{name:"M2 Clicks",color:"#22e6d9"}],sorter:"Clicks Difference"},{keys:[{name:"M1 Order Avg",color:"#e6b122"},{name:"M2 Order Avg",color:"#22e6d9"}],sorter:"Order Difference"}]},null,8,["data"])],64)}r("4de4"),r("4fad");var Ze={name:"Analysis",emits:[],components:{ViewTable:Ve},props:{sqlWorker:Object},data:function(){return{columns:[],values:[],specificColumns:[],specificValues:[],checked:{}}},created:function(){var e=this;this.$store.state.sqlWorker.send({id:this.$store.state.sqlWorker.id,action:"exec",sql:'WITH Visites AS\n                (SELECT \n                  UsersGroups.Id AS "UsersGroupsId",\n                  UsersGroups.Name AS "UserGroupName",\n                  Scenes.Name AS "SceneName",\n                  Scenes.Id AS "SceneId",\n                  Categories.Name AS "CategoryName",\n                  Categories.Id AS "Categories",\n                  \n                  ROW_NUMBER() OVER (\n                                Partition by Users.Id\n                            ) SceneOrder\n                      \n                FROM SceneVisit\n                LEFT JOIN Sessions ON Sessions.Id = SceneVisit.SessionId\n                LEFT JOIN Users ON Sessions.UserId = Users.Id\n                LEFT JOIN UserGroupAssociation ON Users.Id = UserGroupAssociation.UserId\n                LEFT JOIN UsersGroups ON UserGroupAssociation.UserGroupId = UsersGroups.Id\n                LEFT JOIN Scenes ON Scenes.Id = SceneVisit.SceneId\n                LEFT JOIN Categories ON Categories.Id = Scenes.CategoryId\n                WHERE UsersGroups.Type = "Expertise" AND Categories.Name != "Obligatoire" AND Categories.Name != "Tutoriel")\n\n                SELECT \n                  SceneId,\n                  SceneName,\n                  CategoryName,\n                  COUNT(CASE WHEN UserGroupName = "M1" THEN UserGroupName END) AS "M1 Visits",\n                  COUNT(CASE WHEN UserGroupName = "M2" THEN UserGroupName END) AS "M2 Visits",\n                  COUNT(CASE WHEN UserGroupName = "M1" THEN UserGroupName END) - COUNT(CASE WHEN UserGroupName = "M2" THEN UserGroupName END) AS "Visits Difference",\n                  ROUND(AVG(CASE WHEN UserGroupName = "M1" THEN SceneOrder END),2) AS "M1 Order Avg",\n                  ROUND(AVG(CASE WHEN UserGroupName = "M2" THEN SceneOrder END),2) AS "M2 Order Avg",\n                  ROUND(AVG(CASE WHEN UserGroupName = "M1" THEN SceneOrder END) - AVG(CASE WHEN UserGroupName = "M2" THEN SceneOrder END),2) AS "Order Difference"\n                FROM Visites \n                GROUP BY SCeneId\n                ORDER BY "Order Difference";'}).then((function(t){e.columns=t.results[0].columns,e.values=t.results[0].values})),this.$store.commit("incrementWorkerId")},watch:{},mounted:function(){},methods:{changeSceneFocus:function(e,t){var r=this;this.checked[e]=t.currentTarget.checked;var n=Object.entries(this.checked).filter((function(e){return e[1]})).map((function(e){return e[0]})),a="";n.length>0?(a+='Scenes.Id = "'.concat(n.shift(),'"'),n.forEach((function(e){a+=' OR Scenes.Id = "'.concat(e,'"')})),a="AND (".concat(a,")"),this.$store.state.sqlWorker.send({id:this.$store.state.sqlWorker.id,action:"exec",sql:'WITH \n            AllClicks AS (\n            SELECT \n              Topics.Name AS "TopicName",\n              Topics.Id AS "TopicId",\n              Scenes.Name AS "SceneName",\n              Scenes.Id AS "SceneId",\n                Categories.Name AS "CategoryName",\n                Categories.Color AS "CategoryColor",\n                Categories.Id AS "CategoryId",\n              Users.Id AS "UserId",\n              UsersGroups.Name AS "UserGroupName",\n              UsersGroups.Id AS "UserGroupId",\n              ROW_NUMBER() OVER (\n                            Partition by Users.Id\n                        ) TopicOrder\n\n            FROM TopicsClicks\n            LEFT JOIN Topics ON TopicsClicks.TopicId = Topics.Id\n            LEFT JOIN Scenes ON Topics.SceneId = Scenes.Id\n            LEFT JOIN Categories ON Categories.Id = Scenes.CategoryId\n            LEFT JOIN Sessions ON Sessions.Id = TopicsClicks.SessionId\n            LEFT JOIN Users ON Sessions.UserId = Users.Id\n            LEFT JOIN UserGroupAssociation ON Users.Id = UserGroupAssociation.UserId\n            LEFT JOIN UsersGroups ON UserGroupAssociation.UserGroupId = UsersGroups.Id\n            WHERE UsersGroups.Type = "Expertise" AND Categories.Name != "Tutoriel" AND Topics.Name NOT LIKE "Masquer%" '.concat(a,')\n\n\n            SELECT \n              TopicName, SceneName, CategoryName,\n              COUNT(CASE WHEN UserGroupName = "M1" THEN UserGroupName END) AS "M1 Clicks",\n              COUNT(CASE WHEN UserGroupName = "M2" THEN UserGroupName END) AS "M2 Clicks",\n              COUNT(CASE WHEN UserGroupName = "M1" THEN UserGroupName END) - COUNT(CASE WHEN UserGroupName = "M2" THEN UserGroupName END) AS "Clicks Difference",\n              ROUND(AVG(CASE WHEN UserGroupName = "M1" THEN TopicOrder END),2) AS "M1 Order Avg",\n              ROUND(AVG(CASE WHEN UserGroupName = "M2" THEN TopicOrder END),2) AS "M2 Order Avg",\n              ROUND(AVG(CASE WHEN UserGroupName = "M1" THEN TopicOrder END) - AVG(CASE WHEN UserGroupName = "M2" THEN TopicOrder END),2) AS "Order Difference"\n              FROM AllClicks\n              WHERE CategoryName != "Obligatoire"\n            GROUP BY TopicId\n            ORDER BY "Order Difference";')}).then((function(e){r.specificColumns=e.results[0].columns,r.specificValues=e.results[0].values})),this.$store.commit("incrementWorkerId")):(this.specificColumns=[],this.specificValues=[])}}};r("eba0");const et=Ue()(Ze,[["render",Xe],["__scopeId","data-v-2a13370a"]]);var tt=et,rt=function(e){return Object(n["p"])("data-v-0221899a"),e=e(),Object(n["o"])(),e},nt=rt((function(){return Object(n["h"])("input",{id:"userGroup",type:"text",placeholder:"add userGroup"},null,-1)})),at=[nt],st={id:"GroupFilter"},ot=rt((function(){return Object(n["h"])("input",{type:"checkbox",checked:"true",disabled:"true"},null,-1)})),ct={id:"userList"},it=rt((function(){return Object(n["h"])("th",null,"User",-1)})),ut=rt((function(){return Object(n["h"])("br",null,null,-1)})),dt=["value","onChange"],lt=rt((function(){return Object(n["h"])("br",null,null,-1)})),pt=["onClick"],ft=["name","value","onClick","checked"];function bt(e,t,r,a,s,o){return Object(n["n"])(),Object(n["g"])(n["a"],null,[Object(n["h"])("form",{onSubmit:t[0]||(t[0]=Object(n["y"])((function(){return o.addUserGroup&&o.addUserGroup.apply(o,arguments)}),["prevent"]))},at,32),Object(n["h"])("div",st,[(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(o.usersGroups,(function(e){return Object(n["n"])(),Object(n["g"])("span",{key:e.Id,style:Object(n["m"])({color:e.Color})},[ot,Object(n["i"])(" "+Object(n["v"])(e.Name+" : "+e.Type),1)],4)})),128))]),Object(n["h"])("table",ct,[Object(n["h"])("tr",null,[it,(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(o.usersGroups,(function(e){return Object(n["n"])(),Object(n["g"])("th",{key:e.Id},[Object(n["i"])(Object(n["v"])(e.Name),1),ut,Object(n["h"])("input",{type:"color",value:e.Color,onChange:function(t){return o.colorchange(t,e.Id)}},null,40,dt),lt,Object(n["h"])("input",{type:"button",onClick:function(t){return o.deleteUserGroup(e.Id)},value:"Delete"},null,8,pt)])})),128))]),(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(o.users,(function(e){return Object(n["n"])(),Object(n["g"])("tr",{key:e.Id},[Object(n["h"])("td",{style:Object(n["m"])({color:e.Groups[0].Color})},Object(n["v"])(e.Id),5),(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(o.usersGroups,(function(r){return Object(n["n"])(),Object(n["g"])("td",{key:r.Id,onClick:t[1]||(t[1]=function(e){return e.target.querySelector("input").click()})},[Object(n["h"])("input",{type:"checkbox",name:e.Id,value:r.Name,onClick:Object(n["y"])((function(t){return o.updateUserGroupAssociation(e,r.Id)}),["stop"]),checked:e.Groups.find((function(e){return e.Id==r.Id}))},null,8,ft)])})),128))])})),128))])],64)}var mt={name:"UsersSetup",computed:{users:function(){return this.$store.state.users},usersGroups:function(){return this.$store.state.usersGroups}},methods:{addUserGroup:function(e){this.$store.dispatch("addUserGroup",{name:e.srcElement.querySelector("#userGroup").value,color:"#ffffff"})},deleteUserGroup:function(e){this.$store.dispatch("deleteUserGroup",{id:e})},updateUserGroupAssociation:function(e,t){console.log({UserId:e.Id,UserGroupId:t}),e.Groups.find((function(e){return e.Id==t}))?this.$store.dispatch("deleteUserGroupAssociation",{UserId:e.Id,UserGroupId:t}):(console.log("add"),this.$store.dispatch("addUserGroupAssociation",{UserId:e.Id,UserGroupId:t}))},colorchange:function(e,t){this.$store.dispatch("updateUserGroup",{id:t,color:e.srcElement.value})}}};r("906c");const Ot=Ue()(mt,[["render",bt],["__scopeId","data-v-0221899a"]]);var ht=Ot,gt=function(e){return Object(n["p"])("data-v-95a48544"),e=e(),Object(n["o"])(),e},jt={key:0},yt=gt((function(){return Object(n["h"])("div",null,"U",-1)})),vt=gt((function(){return Object(n["h"])("div",null,"A",-1)})),It=[yt,vt],kt={key:1},St=Object(n["i"])("Catergories Setup"),Ut=Object(n["i"])("Users Setup"),Nt=Object(n["i"])("Analysis"),wt=Object(n["i"])("SQL Playground"),Dt=gt((function(){return Object(n["h"])("i",{class:"fas fa-angle-double-left"},null,-1)})),Et=[Dt];function Ct(e,t,r,a,s,o){var c=Object(n["u"])("SidebarLink");return Object(n["n"])(),Object(n["g"])("div",{class:"sidebar",style:Object(n["m"])({width:a.sidebarWidth})},[Object(n["h"])("h1",null,[a.collapsed?(Object(n["n"])(),Object(n["g"])("span",jt,It)):(Object(n["n"])(),Object(n["g"])("span",kt,"Uptale Analysis"))]),Object(n["j"])(c,{onSidebar_click:t[0]||(t[0]=function(t){return e.$emit("sidebar_click","categories")}),icon:"fas fa-edit"},{default:Object(n["x"])((function(){return[St]})),_:1}),Object(n["j"])(c,{onSidebar_click:t[1]||(t[1]=function(t){return e.$emit("sidebar_click","Users")}),icon:"fas fa-edit"},{default:Object(n["x"])((function(){return[Ut]})),_:1}),Object(n["j"])(c,{onSidebar_click:t[2]||(t[2]=function(t){return e.$emit("sidebar_click","Analysis")}),icon:"fas fa-file-csv"},{default:Object(n["x"])((function(){return[Nt]})),_:1}),Object(n["j"])(c,{onSidebar_click:t[3]||(t[3]=function(t){return e.$emit("sidebar_click","SQL")}),icon:"fas fa-database"},{default:Object(n["x"])((function(){return[wt]})),_:1}),Object(n["h"])("span",{class:Object(n["l"])(["collapse-icon",{"rotate-180":a.collapsed}]),onClick:t[4]||(t[4]=function(){return a.toggleSidebar&&a.toggleSidebar.apply(a,arguments)})},Et,2)],4)}var Tt={key:0};function xt(e,t,r,a,s,o){return Object(n["n"])(),Object(n["g"])("div",{class:"sidebarlink",onClick:t[0]||(t[0]=function(t){return e.$emit("sidebar_click")})},[Object(n["h"])("i",{class:Object(n["l"])(["icon",r.icon])},null,2),Object(n["j"])(n["b"],{name:"fade"},{default:Object(n["x"])((function(){return[a.collapsed?Object(n["f"])("",!0):(Object(n["n"])(),Object(n["g"])("span",Tt,[Object(n["t"])(e.$slots,"default",{},void 0,!0)]))]})),_:3})])}var Rt=Object(n["r"])(!1),Gt=function(){return Rt.value=!Rt.value},At=180,Lt=38,$t=Object(n["c"])((function(){return"".concat(Rt.value?Lt:At,"px")})),_t={emits:["sidebar_click"],props:{icon:{type:String,required:!0}},setup:function(e){return{collapsed:Rt}}};r("ddfd");const Mt=Ue()(_t,[["render",xt],["__scopeId","data-v-20a26c90"]]);var Wt=Mt,Pt={emits:["sidebar_click"],props:{},components:{SidebarLink:Wt},setup:function(){return{collapsed:Rt,toggleSidebar:Gt,sidebarWidth:$t}}};r("de53"),r("2334");const Ft=Ue()(Pt,[["render",Ct],["__scopeId","data-v-95a48544"]]);var Ht=Ft,Vt=["value"],qt={key:1,id:"progressMessage"};function zt(e,t,r,a,s,o){var c=Object(n["u"])("FileLoader");return Object(n["n"])(),Object(n["g"])("header",null,[o.progress.progress>0&&o.progress.progress<100?(Object(n["n"])(),Object(n["g"])("progress",{key:0,id:"progress",max:"100",value:o.progress.progress},null,8,Vt)):Object(n["f"])("",!0),o.progress.progress>0&&o.progress.progress<100?(Object(n["n"])(),Object(n["g"])("pre",qt,Object(n["v"])(o.progress.message),1)):Object(n["f"])("",!0),Object(n["h"])("h1",null,Object(n["v"])(r.title),1),Object(n["j"])(c,{onDownloadDatabase:t[0]||(t[0]=function(t){return e.$emit("downloadDatabase")}),isLoading:o.isLoading,serializedDatabase:r.serializedDatabase},null,8,["isLoading","serializedDatabase"])])}var Jt=function(e){return Object(n["p"])("data-v-a2b9753c"),e=e(),Object(n["o"])(),e},Bt={id:"accessButtons"},Qt=Jt((function(){return Object(n["h"])("i",{class:"fas fa-play-circle icon"},null,-1)})),Yt=[Qt],Kt={key:1},Xt=Jt((function(){return Object(n["h"])("i",{class:"fas fa-spinner fa-pulse icon"},null,-1)})),Zt=[Xt],er={key:2},tr=Jt((function(){return Object(n["h"])("i",{class:"fas fa-spinner fa-spin icon"},null,-1)})),rr=[tr],nr=Jt((function(){return Object(n["h"])("i",{class:"fas fa-upload icon"},null,-1)})),ar=[nr],sr=Jt((function(){return Object(n["h"])("i",{class:"fas fa-download icon"},null,-1)})),or=[sr];function cr(e,t,r,a,s,o){var c=Object(n["u"])("Prompt");return Object(n["n"])(),Object(n["g"])(n["a"],null,[Object(n["h"])("div",Bt,[r.isLoading?Object(n["f"])("",!0):(Object(n["n"])(),Object(n["g"])("span",{key:0,onClick:t[0]||(t[0]=function(){return o.startAnalysis&&o.startAnalysis.apply(o,arguments)})},Yt)),1==r.isLoading?(Object(n["n"])(),Object(n["g"])("span",Kt,Zt)):Object(n["f"])("",!0),2==r.isLoading?(Object(n["n"])(),Object(n["g"])("span",er,rr)):Object(n["f"])("",!0),Object(n["h"])("span",{onClick:t[1]||(t[1]=function(e){return s.currentWindow="upload"})},ar),Object(n["h"])("span",{onClick:t[2]||(t[2]=function(){return o.getSerializedDatabase&&o.getSerializedDatabase.apply(o,arguments)})},or)]),"upload"==s.currentWindow?(Object(n["n"])(),Object(n["e"])(c,{key:0,data:s.fields,onFileChange:o.fileChange,onCurrentWindowChange:t[3]||(t[3]=function(e){return s.currentWindow=e}),type:"largePanels"},null,8,["data","onFileChange"])):Object(n["f"])("",!0)],64)}r("a9e3"),r("5cc6"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("72f7"),r("b680"),r("b64b");var ir={class:"prompt"},ur={key:0,id:"content"},dr=["for"],lr=["id","name","accept"],pr={key:1,id:"list"},fr=["href"];function br(e,t,r,a,s,o){return Object(n["n"])(),Object(n["g"])("div",ir,[Object(n["h"])("div",{id:"background",onClick:t[0]||(t[0]=function(t){return e.$emit("currentWindowChange",null)})}),"largePanels"==r.type?(Object(n["n"])(),Object(n["g"])("div",ur,[(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(r.data,(function(r){var a;return Object(n["n"])(),Object(n["g"])("div",{key:r.name,onClick:t[2]||(t[2]=function(){return o.uploadFile&&o.uploadFile.apply(o,arguments)})},[Object(n["h"])("label",{for:r.name},Object(n["v"])(r.label),9,dr),Object(n["h"])("input",{type:"file",id:r.name,name:r.name,accept:"."+r.format,onChange:t[1]||(t[1]=function(t){return e.$emit("fileChange",t)})},null,40,lr),Object(n["h"])("i",null,Object(n["v"])(r.file?r.file.name+" "+((null===(a=r.file)||void 0===a?void 0:a.size)/1e6).toFixed(2)+"MB":""),1)])})),128))])):Object(n["f"])("",!0),"propList"==r.type?(Object(n["n"])(),Object(n["g"])("div",pr,[(Object(n["n"])(!0),Object(n["g"])(n["a"],null,Object(n["s"])(r.data,(function(r,a){return Object(n["n"])(),Object(n["g"])("div",{key:r.Scene,onClick:t[3]||(t[3]=function(){return e.downloadFile&&e.downloadFile.apply(e,arguments)})},[Object(n["h"])("a",{href:"data:text/csv;charset=utf-8,"+encodeURIComponent(o.csvFormat(r))},Object(n["v"])(a),9,fr),Object(n["i"])(" "+Object(n["v"])("".concat(Object.keys(r).length," Utilisateurs")),1)])})),128))])):Object(n["f"])("",!0)])}var mr=r("898b"),Or={name:"Prompt",emits:["fileChange","currentWindowChange"],components:{},data:function(){return{}},props:{data:Object,type:String},created:function(){},methods:{uploadFile:function(e){"DIV"==e.target.tagName&&e.target.querySelector("input").click()},csvFormat:function(e){return mr["a"](Object.values(e))}}};r("4905");const hr=Ue()(Or,[["render",br],["__scopeId","data-v-09cc5462"]]);var gr=hr,jr={name:"FileLoader",components:{Prompt:gr},data:function(){return{currentWindow:"",isLoadingSerializedDatabase:0,fields:[{name:"detail",label:"Select detail data file file here",defaultPath:"/detail.csv",format:"csv"},{name:"database",label:"Select database file here",defaultPath:"/database.db",format:"db"}]}},props:{isLoading:Number,perUserAnswers:Object,serializedDatabase:[]},emits:["updateSerializedDatabase","downloadDatabase"],created:function(){},methods:{load_file:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=function(e){return new Promise((function(e,t){var r=new FileReader;r.onload=function(){e(r.result)},r.onerror=t}))},e.prev=1,e.next=4,r(t);case 4:a=e.sent,n=d3.csvParse(a,d3.autoType),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}(),startAnalysis:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=[],r={},this.fields[0].file&&t.push(this.load_file(this.fields[0].file)),!this.fields[1].file){e.next=11;break}return e.t0=Uint8Array,e.next=7,this.fields[1].file.arrayBuffer();case 7:e.t1=e.sent,r.database=new e.t0(e.t1),e.next=24;break;case 11:return e.next=13,fetch("./database.db");case 13:return e.next=15,e.sent.blob();case 15:if(e.t2=e.sent.type,"application/x-sql; charset=utf-8"!=e.t2){e.next=24;break}return e.t3=Uint8Array,e.next=20,fetch("./database.db");case 20:return e.next=22,e.sent.arrayBuffer();case 22:e.t4=e.sent,r.database=new e.t3(e.t4);case 24:return e.next=26,Promise.all(t);case 26:n=e.sent,r[this.fields[0].name]=n[0],this.$store.dispatch("computeData",r);case 29:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),fileChange:function(e){this.fields.find((function(t){return t.name==e.target.id})).file=e.target.files[0]},mapToArray:function(e){return _e(e)},getSerializedDatabase:function(){this.isLoadingSerializedDatabase=1,this.$emit("downloadDatabase")}}};r("451f");const yr=Ue()(jr,[["render",cr],["__scopeId","data-v-a2b9753c"]]);var vr=yr,Ir={name:"Header",components:{FileLoader:vr},emits:["filesLoaded","updateSerializedDatabase","downloadDatabase"],computed:{isLoading:function(){return this.$store.state.IsLoading},progress:function(){return this.$store.state.progress}},props:{serializedDatabase:[],title:{type:String,default:"[Insert Title here]"},perUserAnswers:Object},methods:{filesLoaded:function(e){this.$emit("filesLoaded",e)}}};r("1603");const kr=Ue()(Ir,[["render",zt],["__scopeId","data-v-43ba0926"]]);var Sr=kr,Ur={name:"App",components:{Header:Sr,SceneList:Re,Sidebar:Ht,Analysis:tt,SQLPlayground:Je,UsersSetup:ht},data:function(){return{title:"VR@COVID Paths Analysis",computeWorker:Worker,serializedDatabase:"",serializedDatabaseURL:"",display:"SQL",sqlDebugData:{columns:[],values:[]}}},setup:function(){return{sidebarWidth:$t}},methods:{sidebarManager:function(e){this.display=e},sceneUpdate:function(e){this.scenes.set(e.id,e),this.updateAndComputePaths()},getSerializedDatabase:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.state.sqlWorker.send({id:e.$store.state.sqlWorker.id,action:"export"});case 2:return r=t.sent.results,e.$store.commit("incrementWorkerId"),t.abrupt("return",new Blob([r],{type:"application/octet-stream"}));case 5:case"end":return t.stop()}}),t)})))()},downloadDatabase:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=1,t.next=3,e.getSerializedDatabase();case 3:e.serializedDatabase=t.sent,URL.revokeObjectURL(e.serializedDatabaseURL),e.serializedDatabaseURL=URL.createObjectURL(e.serializedDatabase),e.loading=0,download.setAttribute("href",e.serializedDatabaseURL),download.click();case 9:case"end":return t.stop()}}),t)})))()}}};r("3c1a");const Nr=Ue()(Ur,[["render",oe]]);var wr=Nr,Dr=(r("7051"),Object(n["d"])(wr));Dr.use(ee),Dr.mount("#app")},"6c3b":function(e,t,r){},"780e":function(e,t,r){},"7bde":function(e,t,r){},"8a3c":function(e,t,r){"use strict";r("063f")},"906c":function(e,t,r){"use strict";r("d314")},"93a8":function(e,t,r){"use strict";r("7bde")},a869:function(e,t,r){"use strict";r("19b0")},ab01:function(e,t,r){},b869:function(e,t,r){"use strict";r("332b")},c4dd:function(e,t,r){"use strict";r("5261")},d314:function(e,t,r){},dc8a:function(e,t,r){"use strict";r("780e")},ddfd:function(e,t,r){"use strict";r("221b")},de53:function(e,t,r){"use strict";r("3aed")},e2b3:function(e,t,r){},eba0:function(e,t,r){"use strict";r("6c3b")},f432:function(e,t,r){}});
//# sourceMappingURL=app.220336d6.js.map