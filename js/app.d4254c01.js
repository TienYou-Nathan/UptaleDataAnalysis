(function(e){function t(t){for(var r,c,o=t[0],i=t[1],u=t[2],l=0,p=[];l<o.length;l++)c=o[l],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&p.push(a[c][0]),a[c]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);d&&d(t);while(p.length)p.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,o=1;o<n.length;o++){var i=n[o];0!==a[i]&&(r=!1)}r&&(s.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={app:0},s=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/UptaleDataAnalysis/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var d=i;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"06b0":function(e,t,n){},"0a4b":function(e,t,n){"use strict";n("ebe2")},"0d8c":function(e,t,n){},"148d":function(e,t,n){},1603:function(e,t,n){"use strict";n("a700")},"1af0":function(e,t,n){"use strict";n("bcac")},"3ad7":function(e,t,n){},4905:function(e,t,n){"use strict";n("88ee")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),a=n("1da1"),s=(n("96cf"),n("5502")),c=n("d4ec"),o=n("bee2"),i=n("ade3"),u=(n("d3b7"),function(){function e(t){var n=this;Object(c["a"])(this,e),Object(i["a"])(this,"worker",void 0),Object(i["a"])(this,"_queue",[]),Object(i["a"])(this,"id",0),this.worker=t,this.worker.onmessage=function(e){"progress"==e.data.type?n.onProgress(e.data):(n._queue[e.data.id].resolve(e.data),delete n._queue[e.data.id])},this.worker.onerror=function(e){n._queue[e.data.id].reject(e.data),delete n._queue[e.data.id]}}return Object(o["a"])(e,[{key:"send",value:function(e){var t=this;if(null==e.id)throw"Data sent to worker does not contains an ID";if(this._queue[e.id])throw"Duplicate ID in data sent to worker";var n=new Promise((function(n,r){t.worker.postMessage(e),t._queue[e.id]={resolve:n,reject:r}}));return n}}]),e}());n("ddb0"),n("159b"),n("b0c0"),n("07ac");function d(e){return(null===e||void 0===e?void 0:e.values.reduce((function(t,n){var r={};return n.forEach((function(t,n){r[e.columns[n]]=t})),t.push(r),t}),[]))||[]}function l(e,t,n){return p.apply(this,arguments)}function p(){return p=Object(a["a"])(regeneratorRuntime.mark((function e(t,n,r){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.send({id:t.id++,action:"exec",sql:n,params:r});case 2:return a=e.sent,a=a&&a.results?a.results[0]:null,e.abrupt("return",d(a));case 5:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function f(e){return b.apply(this,arguments)}function b(){return b=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,'SELECT \n            Scenes.Id, \n            Scenes.Name, \n            Categories.Id AS "CategoryId",\n            Categories.Name AS "CategoryName", \n            Categories.Color AS "CategoryColor",\n            Themes.Id AS "ThemeId", \n            Themes.Name AS "ThemeName", \n            Themes.Color AS "ThemeColor" \n        FROM Scenes \n        LEFT JOIN Categories \n            ON Categories.Id = Scenes.CategoryId \n        LEFT JOIN Themes \n            ON Themes.Id = Scenes.ThemeId'));case 1:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return m=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"SELECT Id, Name, Color FROM Categories"));case 1:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function O(e,t){return g.apply(this,arguments)}function g(){return g=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"INSERT INTO Categories (Name, Color) VALUES ($name, $color)",{$name:n.name,$color:n.color}));case 1:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function j(e,t){return v.apply(this,arguments)}function v(){return v=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"UPDATE Categories SET Color = $color WHERE Id = $id",{$id:n.id,$color:n.color}));case 1:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function y(e,t){return I.apply(this,arguments)}function I(){return I=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"DELETE FROM Categories WHERE Id = $id",{$id:n.id}));case 1:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function k(e){return S.apply(this,arguments)}function S(){return S=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"SELECT Id, Name, Color FROM Themes"));case 1:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function U(e,t){return E.apply(this,arguments)}function E(){return E=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"INSERT INTO Themes (Name, Color) VALUES ($name, $color);",{$name:n.name,$color:n.color}));case 1:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}function w(e,t){return N.apply(this,arguments)}function N(){return N=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"UPDATE Themes SET Color = $color WHERE Id = $id",{$id:n.id,$color:n.color}));case 1:case"end":return e.stop()}}),e)}))),N.apply(this,arguments)}function C(e,t){return T.apply(this,arguments)}function T(){return T=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"DELETE FROM Themes WHERE Id = $id",{$id:n.id}));case 1:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}function D(e,t){return R.apply(this,arguments)}function R(){return R=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"UPDATE Scenes SET CategoryId = $categoryId, ThemeId = $themeId WHERE Id = $id",{$id:n.sceneId,$categoryId:n.categoryId,$themeId:n.themeId}));case 1:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}function A(e){return x.apply(this,arguments)}function x(){return x=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l(t,'SELECT \n    Users.Id AS "UserId",\n    Users.Name AS "UserName",\n    UsersGroups.Id AS "UserGroupId",\n    UsersGroups.Name AS "UserGroupName",\n    UsersGroups.Color AS "UserGroupColor",\n    UsersGroups.Type AS "UserGroupType"\n  FROM Users\n  LEFT JOIN UserGroupAssociation ON UserGroupAssociation.UserId = Users.Id\n  LEFT JOIN UsersGroups ON UsersGroups.Id = UserGroupAssociation.UserGroupId;');case 2:return n=e.sent,n=Object.values(n.reduce((function(e,t){return e[t.UserId]||(e[t.UserId]={Id:t.UserId,Name:t.UserName,Groups:[]}),e[t.UserId].Groups.push({Id:t.UserGroupId,Name:t.UserGroupName,Type:t.UserGroupType,Color:t.UserGroupColor}),e}),{})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function G(e){return L.apply(this,arguments)}function L(){return L=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l(t,'SELECT \n    Sessions.Id AS "SessionId",\n    Sessions.StartTime AS "SessionStart",\n    Sessions.EndTime AS "SessionEnd",\n      Users.Id AS "UserId",\n      Users.Name AS "UserName",\n      UsersGroups.Id AS "UserGroupId",\n      UsersGroups.Name AS "UserGroupName",\n      UsersGroups.Color AS "UserGroupColor",\n      UsersGroups.Type AS "UserGroupType"\n    FROM Users\n    LEFT JOIN UserGroupAssociation ON UserGroupAssociation.UserId = Users.Id\n    LEFT JOIN UsersGroups ON UsersGroups.Id = UserGroupAssociation.UserGroupId\n    LEFT JOIN Sessions ON Sessions.UserId = Users.Id;');case 2:return n=e.sent,n=Object.values(n.reduce((function(e,t){return e[t.SessionId]||(e[t.SessionId]={Id:t.SessionId,StartTime:t.SessionStart,EndTime:t.SessionEnd,Name:t.UserName,User:t.UserId,Groups:[]}),t.UserGroupId&&e[t.SessionId].Groups.push({Id:t.UserGroupId,Name:t.UserGroupName,Type:t.UserGroupType,Color:t.UserGroupColor}),e}),{})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),L.apply(this,arguments)}function $(e){return _.apply(this,arguments)}function _(){return _=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"SELECT Id, Name, Color, Type FROM UsersGroups"));case 1:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}function M(e,t){return W.apply(this,arguments)}function W(){return W=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"INSERT INTO UsersGroups (Name, Color) VALUES ($name, $color)",{$name:n.name,$color:n.color}));case 1:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}function P(e,t){return F.apply(this,arguments)}function F(){return F=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"UPDATE UsersGroups SET Color = $color WHERE Id = $id",{$id:n.id,$color:n.color}));case 1:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}function V(e,t){return H.apply(this,arguments)}function H(){return H=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"DELETE FROM UsersGroups WHERE Id = $id",{$id:n.id}));case 1:case"end":return e.stop()}}),e)}))),H.apply(this,arguments)}function q(e,t){return Q.apply(this,arguments)}function Q(){return Q=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"UPDATE Users SET UserGroupId = $userGroupId WHERE Id = $id",{$id:n.id,$userGroupId:n.userGroupId}));case 1:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}function z(e,t){return J.apply(this,arguments)}function J(){return J=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"INSERT INTO UserGroupAssociation (UserId, UserGroupId) VALUES ($UserId, $UserGroupId)",{$UserId:n.UserId,$UserGroupId:n.UserGroupId}));case 1:case"end":return e.stop()}}),e)}))),J.apply(this,arguments)}function B(e,t){return Y.apply(this,arguments)}function Y(){return Y=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"DELETE FROM UserGroupAssociation WHERE UserId = $UserId AND UserGroupId = $UserGroupId",{$UserId:n.UserId,$UserGroupId:n.UserGroupId}));case 1:case"end":return e.stop()}}),e)}))),Y.apply(this,arguments)}function K(e,t){return X.apply(this,arguments)}function X(){return X=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"INSERT INTO SurveyQuestion (Question) VALUES ($Question)",{$Question:n.Question}));case 1:case"end":return e.stop()}}),e)}))),X.apply(this,arguments)}function Z(e,t){return ee.apply(this,arguments)}function ee(){return ee=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l(t,"INSERT INTO UserAnswers (UserId, QuestionId, Answer)\n    SELECT\n    (SELECT $UserId),\n    (SELECT SurveyQuestion.Id FROM SurveyQuestion WHERE SurveyQuestion.Question == $Question),\n    (SELECT $Answer)",{$UserId:n.UserId,$Question:n.Question,$Answer:n.Answer}));case 1:case"end":return e.stop()}}),e)}))),ee.apply(this,arguments)}function te(e,t){return ne.apply(this,arguments)}function ne(){return ne=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.send({id:t.id++,action:"exec",sql:n});case 2:if(r=e.sent,!r.error){e.next=5;break}throw r.error;case 5:return console.log("output",r.results[0].columns),console.table(r.results[0].values),r=r&&r.results?r.results[0]:null,e.abrupt("return",{data:r,dataObject:d(r)});case 9:case"end":return e.stop()}}),e)}))),ne.apply(this,arguments)}var re=new u(new Worker("scripts/workers/database.js")),ae=Object(s["a"])({state:function(){return{scenes:[],categories:[],themes:[],users:[],usersGroups:[],sessions:[],progress:{progress:0,message:""},isLoading:0,sqlWorker:re}},mutations:{setData:function(e,t){var n=t.key,r=t.value;e[n]=r},incrementWorkerId:function(e){return e.sqlWorker.id++}},actions:{computeData:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.commit,e.state,r("setData",{key:"IsLoading",value:0}),!t.database){n.next=7;break}return n.next=5,re.send({id:re.id++,action:"open",buffer:t.database});case 5:n.next=11;break;case 7:return n.next=9,re.send({id:re.id++,action:"open"});case 9:return n.next=11,re.send({id:re.id++,action:"extractCSVData",files:t});case 11:return n.t0=r,n.next=14,f(re);case 14:return n.t1=n.sent,n.t2={key:"scenes",value:n.t1},(0,n.t0)("setData",n.t2),n.t3=r,n.next=20,h(re);case 20:return n.t4=n.sent,n.t5={key:"categories",value:n.t4},(0,n.t3)("setData",n.t5),n.t6=r,n.next=26,k(re);case 26:return n.t7=n.sent,n.t8={key:"themes",value:n.t7},(0,n.t6)("setData",n.t8),n.t9=r,n.next=32,A(re);case 32:return n.t10=n.sent,n.t11={key:"users",value:n.t10},(0,n.t9)("setData",n.t11),n.t12=r,n.next=38,$(re);case 38:return n.t13=n.sent,n.t14={key:"usersGroups",value:n.t13},(0,n.t12)("setData",n.t14),n.t15=r,n.next=44,G(re);case 44:n.t16=n.sent,n.t17={key:"sessions",value:n.t16},(0,n.t15)("setData",n.t17),r("setData",{key:"IsLoading",value:2}),r("setData",{key:"IsLoading",value:0});case 49:case"end":return n.stop()}}),n)})))()},addCategory:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,O(re,t);case 4:return n.t0=r,n.next=7,h(re);case 7:n.t1=n.sent,n.t2={key:"categories",value:n.t1},(0,n.t0)("setData",n.t2),r("setData",{key:"IsLoading",value:0});case 11:case"end":return n.stop()}}),n)})))()},addTheme:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,U(re,t);case 4:return n.t0=r,n.next=7,k(re);case 7:n.t1=n.sent,n.t2={key:"themes",value:n.t1},(0,n.t0)("setData",n.t2),r("setData",{key:"IsLoading",value:0});case 11:case"end":return n.stop()}}),n)})))()},addUserGroup:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,M(re,t);case 4:return n.t0=r,n.next=7,$(re);case 7:n.t1=n.sent,n.t2={key:"usersGroups",value:n.t1},(0,n.t0)("setData",n.t2),r("setData",{key:"IsLoading",value:0});case 11:case"end":return n.stop()}}),n)})))()},addUserGroupAssociation:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,z(re,t);case 4:return n.t0=r,n.next=7,A(re);case 7:n.t1=n.sent,n.t2={key:"users",value:n.t1},(0,n.t0)("setData",n.t2),r("setData",{key:"IsLoading",value:0});case 11:case"end":return n.stop()}}),n)})))()},updateCategory:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,j(re,t);case 4:return n.t0=r,n.next=7,h(re);case 7:return n.t1=n.sent,n.t2={key:"categories",value:n.t1},(0,n.t0)("setData",n.t2),n.t3=r,n.next=13,f(re);case 13:n.t4=n.sent,n.t5={key:"scenes",value:n.t4},(0,n.t3)("setData",n.t5),r("setData",{key:"IsLoading",value:0});case 17:case"end":return n.stop()}}),n)})))()},updateTheme:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,w(re,t);case 4:return n.t0=r,n.next=7,k(re);case 7:return n.t1=n.sent,n.t2={key:"themes",value:n.t1},(0,n.t0)("setData",n.t2),n.t3=r,n.next=13,f(re);case 13:n.t4=n.sent,n.t5={key:"scenes",value:n.t4},(0,n.t3)("setData",n.t5),r("setData",{key:"IsLoading",value:0});case 17:case"end":return n.stop()}}),n)})))()},updateScene:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,D(re,t);case 4:return n.t0=r,n.next=7,f(re);case 7:n.t1=n.sent,n.t2={key:"scenes",value:n.t1},(0,n.t0)("setData",n.t2),r("setData",{key:"IsLoading",value:0});case 11:case"end":return n.stop()}}),n)})))()},updateUserGroup:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,P(re,t);case 4:return n.t0=r,n.next=7,$(re);case 7:return n.t1=n.sent,n.t2={key:"usersGroups",value:n.t1},(0,n.t0)("setData",n.t2),n.t3=r,n.next=13,A(re);case 13:return n.t4=n.sent,n.t5={key:"users",value:n.t4},(0,n.t3)("setData",n.t5),n.t6=r,n.next=19,G(re);case 19:n.t7=n.sent,n.t8={key:"sessions",value:n.t7},(0,n.t6)("setData",n.t8),r("setData",{key:"IsLoading",value:0});case 23:case"end":return n.stop()}}),n)})))()},updateUser:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,q(re,t);case 4:return n.t0=r,n.next=7,A(re);case 7:return n.t1=n.sent,n.t2={key:"users",value:n.t1},(0,n.t0)("setData",n.t2),n.t3=r,n.next=13,G(re);case 13:n.t4=n.sent,n.t5={key:"sessions",value:n.t4},(0,n.t3)("setData",n.t5),r("setData",{key:"IsLoading",value:0});case 17:case"end":return n.stop()}}),n)})))()},deleteUserGroup:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,V(re,t);case 4:return n.t0=r,n.next=7,$(re);case 7:return n.t1=n.sent,n.t2={key:"usersGroups",value:n.t1},(0,n.t0)("setData",n.t2),n.t3=r,n.next=13,A(re);case 13:return n.t4=n.sent,n.t5={key:"users",value:n.t4},(0,n.t3)("setData",n.t5),n.t6=r,n.next=19,G(re);case 19:n.t7=n.sent,n.t8={key:"sessions",value:n.t7},(0,n.t6)("setData",n.t8),r("setData",{key:"IsLoading",value:0});case 23:case"end":return n.stop()}}),n)})))()},deleteCategory:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,y(re,t);case 4:return n.t0=r,n.next=7,f(re);case 7:return n.t1=n.sent,n.t2={key:"scenes",value:n.t1},(0,n.t0)("setData",n.t2),n.t3=r,n.next=13,h(re);case 13:n.t4=n.sent,n.t5={key:"categories",value:n.t4},(0,n.t3)("setData",n.t5),r("setData",{key:"IsLoading",value:0});case 17:case"end":return n.stop()}}),n)})))()},deleteTheme:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,C(re,t);case 4:return n.t0=r,n.next=7,f(re);case 7:return n.t1=n.sent,n.t2={key:"scenes",value:n.t1},(0,n.t0)("setData",n.t2),n.t3=r,n.next=13,k(re);case 13:n.t4=n.sent,n.t5={key:"themes",value:n.t4},(0,n.t3)("setData",n.t5),r("setData",{key:"IsLoading",value:0});case 17:case"end":return n.stop()}}),n)})))()},deleteUserGroupAssociation:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,e.state,r("setData",{key:"IsLoading",value:1}),n.next=4,B(re,t);case 4:return n.t0=r,n.next=7,A(re);case 7:return n.t1=n.sent,n.t2={key:"users",value:n.t1},(0,n.t0)("setData",n.t2),n.t3=r,n.next=13,G(re);case 13:n.t4=n.sent,n.t5={key:"sessions",value:n.t4},(0,n.t3)("setData",n.t5),r("setData",{key:"IsLoading",value:0});case 17:case"end":return n.stop()}}),n)})))()},addQuestion:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.commit,e.state,n.next=3,K(re,t);case 3:case"end":return n.stop()}}),n)})))()},addAnswer:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.commit,e.state,n.next=3,Z(re,t);case 3:case"end":return n.stop()}}),n)})))()}}});re.onProgress=function(e){ae.commit("setData",{key:"progress",value:0})};var se=["href"],ce={key:0},oe={key:1,id:"container"},ie={key:2},ue={key:3},de=["hidden"];function le(e,t,n,a,s,c){var o=Object(r["u"])("Sidebar"),i=Object(r["u"])("Header"),u=Object(r["u"])("SceneList"),d=Object(r["u"])("UsersSetup"),l=Object(r["u"])("Analysis"),p=Object(r["u"])("SurveyLink"),f=Object(r["u"])("SQLPlayground");return Object(r["n"])(),Object(r["g"])(r["a"],null,[Object(r["j"])(o,{onSidebar_click:c.sidebarManager},null,8,["onSidebar_click"]),Object(r["h"])("a",{id:"download",display:"none",href:s.serializedDatabaseURL,download:"database.db"},null,8,se),Object(r["h"])("div",{id:"nav",style:Object(r["m"])({"margin-left":a.sidebarWidth})},[Object(r["j"])(i,{id:"Header",title:"",onDownloadDatabase:c.downloadDatabase},null,8,["onDownloadDatabase"]),"categories"==s.display?(Object(r["n"])(),Object(r["g"])("div",ce,[Object(r["j"])(u)])):Object(r["f"])("",!0),"Users"==s.display?(Object(r["n"])(),Object(r["g"])("div",oe,[Object(r["j"])(d)])):Object(r["f"])("",!0),"Analysis"==s.display?(Object(r["n"])(),Object(r["g"])("div",ie,[Object(r["j"])(l)])):Object(r["f"])("",!0),"SurveyLink"==s.display?(Object(r["n"])(),Object(r["g"])("div",ue,[Object(r["j"])(p)])):Object(r["f"])("",!0),Object(r["h"])("div",{id:"container",hidden:!("SQL"==s.display)},[Object(r["j"])(f)],8,de)],4)],64)}n("3ca3"),n("2b3d"),n("9861");var pe=function(e){return Object(r["p"])("data-v-24b045ad"),e=e(),Object(r["o"])(),e},fe=pe((function(){return Object(r["h"])("input",{id:"categoryName",type:"text",placeholder:"add category"},null,-1)})),be=[fe],he=pe((function(){return Object(r["h"])("input",{id:"themeName",type:"text",placeholder:"add theme"},null,-1)})),me=[he],Oe={id:"sceneList"},ge={id:"categoryList"},je={class:"sticky"},ve={id:"themeList"},ye={class:"sticky"};function Ie(e,t,n,a,s,c){var o=Object(r["u"])("Scene"),i=Object(r["u"])("SceneProperty");return Object(r["n"])(),Object(r["g"])(r["a"],null,[Object(r["h"])("form",{onSubmit:t[0]||(t[0]=function(){return c.addCategory&&c.addCategory.apply(c,arguments)})},be,32),Object(r["h"])("form",{onSubmit:t[1]||(t[1]=function(){return c.addTheme&&c.addTheme.apply(c,arguments)})},me,32),Object(r["h"])("div",Oe,[(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(c.scenes,(function(e){return Object(r["n"])(),Object(r["e"])(o,{key:e.Id,scene:e,onUpdateScene:c.updateScene},null,8,["scene","onUpdateScene"])})),128)),Object(r["h"])("div",ge,[Object(r["h"])("div",je,[(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(c.categories,(function(e){return Object(r["n"])(),Object(r["e"])(i,{key:e.Id,id:e.Id,name:e.Name,color:e.Color,persistent:!0,type:"category",onDeleteProperty:c.deleteCategory,onUpdateProperty:c.updateCategory},null,8,["id","name","color","onDeleteProperty","onUpdateProperty"])})),128))])]),Object(r["h"])("div",ve,[Object(r["h"])("div",ye,[(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(c.themes,(function(e){return Object(r["n"])(),Object(r["e"])(i,{key:e.Id,id:e.Id,name:e.Name,color:e.Color,persistent:!0,type:"theme",onDeleteProperty:c.deleteTheme,onUpdateProperty:c.updateTheme},null,8,["id","name","color","onDeleteProperty","onUpdateProperty"])})),128))])])])],64)}function ke(e,t,n,a,s,c){var o=Object(r["u"])("SceneProperty");return Object(r["n"])(),Object(r["g"])("div",{class:"scene",onDragenter:t[0]||(t[0]=function(){return c.dragEnter&&c.dragEnter.apply(c,arguments)}),onDragleave:t[1]||(t[1]=function(){return c.dragLeave&&c.dragLeave.apply(c,arguments)}),onDragover:t[2]||(t[2]=function(){return c.dragOver&&c.dragOver.apply(c,arguments)}),onDrop:t[3]||(t[3]=function(){return c.drop&&c.drop.apply(c,arguments)}),style:Object(r["m"])({border:"1px solid "+s.border_color})},[Object(r["h"])("span",null,Object(r["v"])(n.scene.Name),1),Object(r["j"])(o,{id:n.scene.CategoryId,name:n.scene.CategoryName,color:n.scene.CategoryColor,type:"category",border:s.borders.category},null,8,["id","name","color","border"]),Object(r["j"])(o,{id:n.scene.ThemeId,name:n.scene.ThemeName,color:n.scene.ThemeColor,type:"theme",border:s.borders.theme},null,8,["id","name","color","border"])],36)}var Se=["draggable"],Ue={class:"propertyName"},Ee=["value"];function we(e,t,n,a,s,c){return Object(r["n"])(),Object(r["g"])("span",{class:Object(r["l"])(["container",n.persistent?"persistent":null]),onDragstart:t[2]||(t[2]=function(){return c.dragStart&&c.dragStart.apply(c,arguments)}),onDragend:t[3]||(t[3]=function(){return c.dragEnd&&c.dragEnd.apply(c,arguments)}),style:Object(r["m"])({background:n.color,opacity:s.opacity,border:n.border}),draggable:!!this.persistent},[Object(r["h"])("span",Ue,Object(r["v"])(n.name),1),n.persistent?(Object(r["n"])(),Object(r["g"])("input",{key:0,type:"color",value:n.color,onChange:t[0]||(t[0]=function(){return c.colorchange&&c.colorchange.apply(c,arguments)})},null,40,Ee)):Object(r["f"])("",!0),n.persistent?(Object(r["n"])(),Object(r["g"])("button",{key:1,onClick:t[1]||(t[1]=function(){return c.deleteProperty&&c.deleteProperty.apply(c,arguments)})},"Delete")):Object(r["f"])("",!0)],46,Se)}var Ne={name:"SceneProperty",data:function(){return{opacity:1}},emits:["deleteProperty","updateProperty"],props:{id:"",color:"",name:"",persistent:{type:Boolean,default:!1},type:{type:String,default:"category"},border:{type:String,default:""}},methods:{dragStart:function(e){e.dropEffect="move",e.dataTransfer.effectAllowed=this.persistent?"copy":"move",e.dataTransfer.setData("Id",this.id),e.dataTransfer.setData("type",this.type),this.opacity=.5},dragEnd:function(){this.opacity=1},colorchange:function(e){this.$emit("updateProperty",{color:e.srcElement.value,id:this.id})},deleteProperty:function(){this.$emit("deleteProperty",{id:this.id})}}},Ce=(n("b869"),n("6b0d")),Te=n.n(Ce);const De=Te()(Ne,[["render",we],["__scopeId","data-v-46de3cf3"]]);var Re=De,Ae={name:"Scene",emits:["updateScene"],components:{SceneProperty:Re},data:function(){return{border_color:"transparent",borders:{category:null,theme:null}}},props:{scene:{type:Object}},methods:{dragEnter:function(e){e.preventDefault()},dragLeave:function(e){this.border_color="transparent",this.borders[e.dataTransfer.getData("type")]=null},dragOver:function(e){e.preventDefault(),this.border_color="black",this.borders[e.dataTransfer.getData("type")]="2px solid red"},drop:function(e){e.preventDefault(),this.border_color="transparent",this.borders[e.dataTransfer.getData("type")]=null,"theme"==e.dataTransfer.getData("type")?this.scene.ThemeId=e.dataTransfer.getData("Id"):"category"==e.dataTransfer.getData("type")&&(this.scene.CategoryId=e.dataTransfer.getData("Id")),this.$emit("updateScene",{sceneId:this.scene.Id,categoryId:this.scene.CategoryId,themeId:this.scene.ThemeId})}}};n("93a8");const xe=Te()(Ae,[["render",ke],["__scopeId","data-v-f86c4c40"]]);var Ge=xe,Le={name:"SceneList",components:{Scene:Ge,SceneProperty:Re},computed:{scenes:function(){return this.$store.state.scenes},categories:function(){return this.$store.state.categories},themes:function(){return this.$store.state.themes}},methods:{addCategory:function(e){e.preventDefault(),this.$store.dispatch("addCategory",{name:e.srcElement.querySelector("#categoryName").value,color:"#ffffff"})},addTheme:function(e){e.preventDefault(),this.$store.dispatch("addTheme",{name:e.srcElement.querySelector("#themeName").value,color:"#ffffff"})},updateCategory:function(e){this.$store.dispatch("updateCategory",e)},updateTheme:function(e){this.$store.dispatch("updateTheme",e)},updateScene:function(e){this.$store.dispatch("updateScene",e)},deleteCategory:function(e){this.$store.dispatch("deleteCategory",e)},deleteTheme:function(e){this.$store.dispatch("deleteTheme",e)}}};n("dc8a");const $e=Te()(Le,[["render",Ie],["__scopeId","data-v-24b045ad"]]);var _e=$e,Me={id:"area",ref:"area",autonomplete:"on",autocorrect:"off",spellcheck:"off"},We=["href"];function Pe(e,t,n,a,s,c){var o=Object(r["u"])("ViewTable");return Object(r["n"])(),Object(r["g"])(r["a"],null,[Object(r["h"])("textarea",Me,null,512),s.downloadDataURL?(Object(r["n"])(),Object(r["g"])("a",{key:0,href:s.downloadDataURL,download:"result.csv"},"Download Results",8,We)):Object(r["f"])("",!0),Object(r["j"])(o,{data:{columns:s.data.columns,values:s.reducedValues}},null,8,["data"])],64)}var Fe=n("2909"),Ve=(n("a434"),n("99af"),n("4ec9"),n("d81d"),n("ac1f"),n("1276"),n("7db0"),n("2ca0"),n("e9c4"),function(e){var t=[];return e.forEach((function(e,n){e.id=n,t.push(e)})),t}),He=function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))},qe=(n("4e82"),["onClick"]);function Qe(e,t,n,a,s,c){return Object(r["n"])(),Object(r["g"])("table",null,[Object(r["i"])(Object(r["v"])(n.title)+" ",1),Object(r["h"])("tr",null,[(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(n.data.columns,(function(e,t){return Object(r["n"])(),Object(r["g"])("th",{key:e,onClick:function(n){return c.sort(e,t)}},Object(r["v"])(e+(s.sortIndex==t?s.sortDirection?"▲":"▼":" ")),9,qe)})),128))]),(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(c.sortedValues,(function(e,t){return Object(r["n"])(),Object(r["g"])("tr",{key:e},[(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(e,(function(e,a){return Object(r["n"])(),Object(r["g"])("td",{key:e,style:Object(r["m"])(n.compare?{background:c.gradientSortedValues[t][a]}:null)},Object(r["v"])(e),5)})),128))])})),128))])}var ze={name:"ViewTable",components:{},data:function(){return{sortIndex:0,sortDirection:!1}},computed:{sortedValues:function(){var e=this;return this.data.values.sort((function(t,n){var r=t[e.sortIndex],a=n[e.sortIndex],s=0;return r<a&&(s=-1),r>a&&(s=1),e.sortDirection&&(s*=-1),s}))},gradientSortedValues:function(){var e,t=this,n=[];return null===(e=this.compare)||void 0===e||e.forEach((function(e){var r=t.data.columns.indexOf(e.sorter),a=e.keys.map((function(e){return t.data.columns.indexOf(e.name)}));t.sortedValues.forEach((function(s,c){n[c]||(n[c]=[]);var o=Math.max.apply(Math,Object(Fe["a"])(t.sortedValues.map((function(e){return Math.abs(e[a[0]]-e[a[1]])})))),i=(s[a[0]]-s[a[1]])/o;n[c][r]=i>0?"linear-gradient(90deg, #ffffff ".concat(50-50*i,"%, ").concat(e.keys[0].color," ").concat(50-50*i,"%,  ").concat(e.keys[0].color," 50%,  #ffffff 50%)"):"linear-gradient(90deg, #ffffff 50%, ".concat(e.keys[1].color," 50%,").concat(e.keys[1].color," ").concat(50-50*i,"%,\n            #ffffff ").concat(50-50*i,"%\n            )")}))})),n}},props:{title:null,data:{columns:[],values:[]},compare:Array},methods:{sort:function(e,t){this.sortIndex==t?this.sortDirection=!this.sortDirection:(this.sortIndex=t,this.sortDirection=!1)}}};n("8a3c");const Je=Te()(ze,[["render",Qe],["__scopeId","data-v-6a663299"]]);var Be=Je,Ye={name:"SQLPlayground",emits:["SQLRequest","progress"],components:{ViewTable:Be},data:function(){return{data:{columns:[],values:[]},dataObject:{},downloadDataURL:null,reducedValues:[],reducedInterval:0,codeMirror:null}},watch:{dataObject:function(){URL.revokeObjectURL(this.downloadDataURL),this.downloadDataURL=URL.createObjectURL(new Blob([d3.csvFormat(this.dataObject)],{type:"text/csv"}))},data:function(){this.showData()}},props:{columns:Array,values:Array},mounted:function(){var e;this.codeMirror=CodeMirror.fromTextArea(this.$refs.area,(e={lineNumbers:!0,mode:"text/x-mysql",viewportMargin:1/0,indentWithTabs:!0,smartIndent:!0},Object(i["a"])(e,"lineNumbers",!0),Object(i["a"])(e,"matchBrackets",!0),Object(i["a"])(e,"autofocus",!0),Object(i["a"])(e,"extraKeys",{"Ctrl-Enter":this.execEditorContents}),e))},methods:{execEditorContents:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,te(e.$store.state.sqlWorker,e.codeMirror.getValue()+";");case 2:n=t.sent,e.data=n.data,e.dataObject=n.dataObject;case 5:case"end":return t.stop()}}),t)})))()},showData:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r,a,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return clearInterval(e.reducedInterval),e.$store.commit("setData",{key:"progress",value:{progress:100}}),n=15,r=25,t.next=6,He(n);case 6:e.reducedValues=[],a=Object(Fe["a"])(e.data.values),s=e.data.values.length,c=0,e.reducedInterval=setInterval((function(){var t=a.splice(r);e.reducedValues=[].concat(Object(Fe["a"])(e.reducedValues),Object(Fe["a"])(a)),a=t,c=e.reducedValues.length,e.$store.commit("setData",{key:"progress",value:{progress:100*c/s,message:"Displaying results\n".concat(c,"/").concat(s,"\nCSV ready")}}),0==a.length&&clearInterval(e.reducedInterval)}),n);case 11:case"end":return t.stop()}}),t)})))()}}};n("a869"),n("c4dd");const Ke=Te()(Ye,[["render",Pe],["__scopeId","data-v-4b63d529"]]);var Xe=Ke,Ze=function(e){return Object(r["p"])("data-v-2a13370a"),e=e(),Object(r["o"])(),e},et=Object(r["i"])(" Visite des Scenes "),tt=Ze((function(){return Object(r["h"])("th",null,"Focus",-1)})),nt=["onChange"];function rt(e,t,n,a,s,c){var o=Object(r["u"])("ViewTable");return Object(r["n"])(),Object(r["g"])(r["a"],null,[Object(r["h"])("table",null,[et,Object(r["h"])("tr",null,[tt,(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(s.columns,(function(e){return Object(r["n"])(),Object(r["g"])("th",{key:e},Object(r["v"])(e),1)})),128))]),(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(s.values,(function(e){return Object(r["n"])(),Object(r["g"])("tr",{key:e},[Object(r["h"])("td",null,[Object(r["h"])("input",{type:"checkbox",name:"focus",onChange:function(t){return c.changeSceneFocus(e[0],t)}},null,40,nt)]),(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(e,(function(e){return Object(r["n"])(),Object(r["g"])("td",{key:e},Object(r["v"])(e),1)})),128))])})),128))]),Object(r["j"])(o,{title:"Clicks sur les tags",data:{columns:s.specificColumns,values:s.specificValues},compare:[{keys:[{name:"M1 Clicks",color:"#e6b122"},{name:"M2 Clicks",color:"#22e6d9"}],sorter:"Clicks Difference"},{keys:[{name:"M1 Order Avg",color:"#e6b122"},{name:"M2 Order Avg",color:"#22e6d9"}],sorter:"Order Difference"}]},null,8,["data"])],64)}n("4de4"),n("4fad");var at={name:"Analysis",emits:[],components:{ViewTable:Be},props:{sqlWorker:Object},data:function(){return{columns:[],values:[],specificColumns:[],specificValues:[],checked:{}}},created:function(){var e=this;this.$store.state.sqlWorker.send({id:this.$store.state.sqlWorker.id,action:"exec",sql:'WITH Visites AS\n                (SELECT \n                  UsersGroups.Id AS "UsersGroupsId",\n                  UsersGroups.Name AS "UserGroupName",\n                  Scenes.Name AS "SceneName",\n                  Scenes.Id AS "SceneId",\n                  Categories.Name AS "CategoryName",\n                  Categories.Id AS "Categories",\n                  \n                  ROW_NUMBER() OVER (\n                                Partition by Users.Id\n                            ) SceneOrder\n                      \n                FROM SceneVisit\n                LEFT JOIN Sessions ON Sessions.Id = SceneVisit.SessionId\n                LEFT JOIN Users ON Sessions.UserId = Users.Id\n                LEFT JOIN UserGroupAssociation ON Users.Id = UserGroupAssociation.UserId\n                LEFT JOIN UsersGroups ON UserGroupAssociation.UserGroupId = UsersGroups.Id\n                LEFT JOIN Scenes ON Scenes.Id = SceneVisit.SceneId\n                LEFT JOIN Categories ON Categories.Id = Scenes.CategoryId\n                WHERE UsersGroups.Type = "Expertise" AND Categories.Name != "Obligatoire" AND Categories.Name != "Tutoriel")\n\n                SELECT \n                  SceneId,\n                  SceneName,\n                  CategoryName,\n                  COUNT(CASE WHEN UserGroupName = "M1" THEN UserGroupName END) AS "M1 Visits",\n                  COUNT(CASE WHEN UserGroupName = "M2" THEN UserGroupName END) AS "M2 Visits",\n                  COUNT(CASE WHEN UserGroupName = "M1" THEN UserGroupName END) - COUNT(CASE WHEN UserGroupName = "M2" THEN UserGroupName END) AS "Visits Difference",\n                  ROUND(AVG(CASE WHEN UserGroupName = "M1" THEN SceneOrder END),2) AS "M1 Order Avg",\n                  ROUND(AVG(CASE WHEN UserGroupName = "M2" THEN SceneOrder END),2) AS "M2 Order Avg",\n                  ROUND(AVG(CASE WHEN UserGroupName = "M1" THEN SceneOrder END) - AVG(CASE WHEN UserGroupName = "M2" THEN SceneOrder END),2) AS "Order Difference"\n                FROM Visites \n                GROUP BY SCeneId\n                ORDER BY "Order Difference";'}).then((function(t){e.columns=t.results[0].columns,e.values=t.results[0].values})),this.$store.commit("incrementWorkerId")},watch:{},mounted:function(){},methods:{changeSceneFocus:function(e,t){var n=this;this.checked[e]=t.currentTarget.checked;var r=Object.entries(this.checked).filter((function(e){return e[1]})).map((function(e){return e[0]})),a="";r.length>0?(a+='Scenes.Id = "'.concat(r.shift(),'"'),r.forEach((function(e){a+=' OR Scenes.Id = "'.concat(e,'"')})),a="AND (".concat(a,")"),this.$store.state.sqlWorker.send({id:this.$store.state.sqlWorker.id,action:"exec",sql:'WITH \n            AllClicks AS (\n            SELECT \n              Topics.Name AS "TopicName",\n              Topics.Id AS "TopicId",\n              Scenes.Name AS "SceneName",\n              Scenes.Id AS "SceneId",\n                Categories.Name AS "CategoryName",\n                Categories.Color AS "CategoryColor",\n                Categories.Id AS "CategoryId",\n              Users.Id AS "UserId",\n              UsersGroups.Name AS "UserGroupName",\n              UsersGroups.Id AS "UserGroupId",\n              ROW_NUMBER() OVER (\n                            Partition by Users.Id\n                        ) TopicOrder\n\n            FROM TopicsClicks\n            LEFT JOIN Topics ON TopicsClicks.TopicId = Topics.Id\n            LEFT JOIN Scenes ON Topics.SceneId = Scenes.Id\n            LEFT JOIN Categories ON Categories.Id = Scenes.CategoryId\n            LEFT JOIN Sessions ON Sessions.Id = TopicsClicks.SessionId\n            LEFT JOIN Users ON Sessions.UserId = Users.Id\n            LEFT JOIN UserGroupAssociation ON Users.Id = UserGroupAssociation.UserId\n            LEFT JOIN UsersGroups ON UserGroupAssociation.UserGroupId = UsersGroups.Id\n            WHERE UsersGroups.Type = "Expertise" AND Categories.Name != "Tutoriel" AND Topics.Name NOT LIKE "Masquer%" '.concat(a,')\n\n\n            SELECT \n              TopicName, SceneName, CategoryName,\n              COUNT(CASE WHEN UserGroupName = "M1" THEN UserGroupName END) AS "M1 Clicks",\n              COUNT(CASE WHEN UserGroupName = "M2" THEN UserGroupName END) AS "M2 Clicks",\n              COUNT(CASE WHEN UserGroupName = "M1" THEN UserGroupName END) - COUNT(CASE WHEN UserGroupName = "M2" THEN UserGroupName END) AS "Clicks Difference",\n              ROUND(AVG(CASE WHEN UserGroupName = "M1" THEN TopicOrder END),2) AS "M1 Order Avg",\n              ROUND(AVG(CASE WHEN UserGroupName = "M2" THEN TopicOrder END),2) AS "M2 Order Avg",\n              ROUND(AVG(CASE WHEN UserGroupName = "M1" THEN TopicOrder END) - AVG(CASE WHEN UserGroupName = "M2" THEN TopicOrder END),2) AS "Order Difference"\n              FROM AllClicks\n              WHERE CategoryName != "Obligatoire"\n            GROUP BY TopicId\n            ORDER BY "Order Difference";')}).then((function(e){n.specificColumns=e.results[0].columns,n.specificValues=e.results[0].values})),this.$store.commit("incrementWorkerId")):(this.specificColumns=[],this.specificValues=[])}}};n("eba0");const st=Te()(at,[["render",rt],["__scopeId","data-v-2a13370a"]]);var ct=st,ot=function(e){return Object(r["p"])("data-v-0221899a"),e=e(),Object(r["o"])(),e},it=ot((function(){return Object(r["h"])("input",{id:"userGroup",type:"text",placeholder:"add userGroup"},null,-1)})),ut=[it],dt={id:"GroupFilter"},lt=ot((function(){return Object(r["h"])("input",{type:"checkbox",checked:"true",disabled:"true"},null,-1)})),pt={id:"userList"},ft=ot((function(){return Object(r["h"])("th",null,"User",-1)})),bt=ot((function(){return Object(r["h"])("br",null,null,-1)})),ht=["value","onChange"],mt=ot((function(){return Object(r["h"])("br",null,null,-1)})),Ot=["onClick"],gt=["name","value","onClick","checked"];function jt(e,t,n,a,s,c){return Object(r["n"])(),Object(r["g"])(r["a"],null,[Object(r["h"])("form",{onSubmit:t[0]||(t[0]=Object(r["y"])((function(){return c.addUserGroup&&c.addUserGroup.apply(c,arguments)}),["prevent"]))},ut,32),Object(r["h"])("div",dt,[(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(c.usersGroups,(function(e){return Object(r["n"])(),Object(r["g"])("span",{key:e.Id,style:Object(r["m"])({color:e.Color})},[lt,Object(r["i"])(" "+Object(r["v"])(e.Name+" : "+e.Type),1)],4)})),128))]),Object(r["h"])("table",pt,[Object(r["h"])("tr",null,[ft,(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(c.usersGroups,(function(e){return Object(r["n"])(),Object(r["g"])("th",{key:e.Id},[Object(r["i"])(Object(r["v"])(e.Name),1),bt,Object(r["h"])("input",{type:"color",value:e.Color,onChange:function(t){return c.colorchange(t,e.Id)}},null,40,ht),mt,Object(r["h"])("input",{type:"button",onClick:function(t){return c.deleteUserGroup(e.Id)},value:"Delete"},null,8,Ot)])})),128))]),(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(c.users,(function(e){return Object(r["n"])(),Object(r["g"])("tr",{key:e.Id},[Object(r["h"])("td",{style:Object(r["m"])({color:e.Groups[0].Color})},Object(r["v"])(e.Id),5),(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(c.usersGroups,(function(n){return Object(r["n"])(),Object(r["g"])("td",{key:n.Id,onClick:t[1]||(t[1]=function(e){return e.target.querySelector("input").click()})},[Object(r["h"])("input",{type:"checkbox",name:e.Id,value:n.Name,onClick:Object(r["y"])((function(t){return c.updateUserGroupAssociation(e,n.Id)}),["stop"]),checked:e.Groups.find((function(e){return e.Id==n.Id}))},null,8,gt)])})),128))])})),128))])],64)}var vt={name:"UsersSetup",computed:{users:function(){return this.$store.state.users},usersGroups:function(){return this.$store.state.usersGroups}},methods:{addUserGroup:function(e){this.$store.dispatch("addUserGroup",{name:e.srcElement.querySelector("#userGroup").value,color:"#ffffff"})},deleteUserGroup:function(e){this.$store.dispatch("deleteUserGroup",{id:e})},updateUserGroupAssociation:function(e,t){console.log({UserId:e.Id,UserGroupId:t}),e.Groups.find((function(e){return e.Id==t}))?this.$store.dispatch("deleteUserGroupAssociation",{UserId:e.Id,UserGroupId:t}):(console.log("add"),this.$store.dispatch("addUserGroupAssociation",{UserId:e.Id,UserGroupId:t}))},colorchange:function(e,t){this.$store.dispatch("updateUserGroup",{id:t,color:e.srcElement.value})}}};n("906c");const yt=Te()(vt,[["render",jt],["__scopeId","data-v-0221899a"]]);var It=yt,kt=["accept"],St=Object(r["h"])("br",null,null,-1),Ut=Object(r["h"])("thead",null,[Object(r["h"])("tr",null,[Object(r["h"])("th",null,"Csv"),Object(r["h"])("th",null,"Uptale"),Object(r["h"])("th",null,"Incertitude")])],-1),Et={key:0},wt=["onClick"],Nt=["onClick"],Ct=["onClick"],Tt={key:0},Dt=["onInput"],Rt=["value"];function At(e,t,n,a,s,c){return Object(r["n"])(),Object(r["g"])(r["a"],null,[Object(r["h"])("input",{type:"file",accept:".csv",onChange:t[0]||(t[0]=function(){return c.fileChange&&c.fileChange.apply(c,arguments)})},null,40,kt),Object(r["h"])("button",{onClick:t[1]||(t[1]=function(){return c.saveData&&c.saveData.apply(c,arguments)})},"Importer"),St,Object(r["h"])("span",null,"Validated : "+Object(r["v"])(s.defaultUserAssociation.filter((function(e){return 0==e[2]})).length),1),Object(r["h"])("table",null,[Ut,(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(s.defaultUserAssociation,(function(e){return Object(r["n"])(),Object(r["g"])(r["a"],{key:e[0]},[e[2]&&e[2]>0?(Object(r["n"])(),Object(r["g"])("tr",Et,[Object(r["h"])("th",null,Object(r["v"])(e[0]),1),Object(r["h"])("th",null,Object(r["v"])(e[1]),1),Object(r["h"])("th",null,Object(r["v"])(e[2]),1),Object(r["h"])("th",null,[Object(r["h"])("button",{onClick:function(t){return c.validateAssociation(e[0])}},"Validate",8,wt)]),Object(r["h"])("th",null,[Object(r["h"])("button",{onClick:function(t){return c.requestChangeAssociation(e[0])}}," edit ",8,Nt)]),Object(r["h"])("th",null,[e[1]?(Object(r["n"])(),Object(r["g"])("button",{key:0,onClick:function(t){return c.deleteAssociation(e[0])}}," delete ",8,Ct)):Object(r["f"])("",!0)]),e[3]?(Object(r["n"])(),Object(r["g"])("th",Tt,[Object(r["h"])("select",{onInput:function(t){return c.changeAssociation(e[0],t)}},[(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(e[3],(function(e){return Object(r["n"])(),Object(r["g"])("option",{key:e,value:e[0]},Object(r["v"])(e[0]),9,Rt)})),128))],40,Dt)])):Object(r["f"])("",!0)])):Object(r["f"])("",!0)],64)})),128))])],64)}n("5319"),n("b64b"),n("a630");var xt=n("31d5"),Gt={name:"SurveyLink",computed:{users:function(){return this.$store.state.users}},data:function(){return{originalCSV:[],levensteinCache:{},defaultUserAssociation:[],associationData:{},uptaleEmail:" (leafrigo@hotmail.com)"}},methods:{load_file:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsText(e)}))},e.prev=1,e.next=4,n(t);case 4:a=e.sent,r=d3.csvParse(a,d3.autoType),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0);case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}(),fileChange:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,a,s,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={},n.next=3,t.load_file(e.target.files[0]);case 3:a=n.sent,t.originalCSV=a,console.log(a),s=a.map((function(e){return e["2. Nom &amp; Prénom :"]})),c=t.users.map((function(e){return e.Id.replace(t.uptaleEmail,"")})),s.forEach((function(e){r[e]={};var n=t.stringToWords(e);c.forEach((function(a){var s=t.stringToWords(a);s.length>1&&(r[e][a]=t.nwordlevenstein(n,s))}))})),t.associationData=r,t.defaultUserAssociation=Object.entries(r).map((function(e){return[e[0]].concat(Object(Fe["a"])(Object.entries(e[1]).reduce((function(e,t){return e[1]<t[1]?e:t}),["",1/0])))})),t.defaultUserAssociation.sort((function(e,t){return e[2]<t[2]?-1:e[2]>t[2]?1:0})),console.log();case 13:case"end":return n.stop()}}),n)})))()},nwordlevenstein:function(e,t){return 3==e.length&&3==t.length?Math.min(this.levensteinCached(e[0],t[0])+this.levensteinCached(e[1],t[1])+this.levensteinCached(e[2],t[2]),this.levensteinCached(e[0],t[1])+this.levensteinCached(e[1],t[2])+this.levensteinCached(e[2],t[0]),this.levensteinCached(e[0],t[2])+this.levensteinCached(e[1],t[0])+this.levensteinCached(e[2],t[1])):2==e.length&&2==t.length?Math.min(this.levensteinCached(e[0],t[0])+this.levensteinCached(e[1],t[1]),this.levensteinCached(e[1],t[0])+this.levensteinCached(e[0],t[1])):1/0},levensteinCached:function(e,t){return this.levensteinCache[e]&&this.levensteinCache[e][t]?this.levensteinCache[e][t]:this.levensteinCache[t]&&this.levensteinCache[t][e]?this.levensteinCache[t][e]:(this.levensteinCache[e]||(this.levensteinCache[e]={}),this.levensteinCache[e][t]=xt(e,t),this.levensteinCache[e][t])},stringToWords:function(e){return e.toLowerCase().replace(/[^A-Za-z\s!?]/g,"").split(" ").filter((function(e){return e.length>0}))},requestChangeAssociation:function(e){this.defaultUserAssociation.find((function(t){return t[0]==e}))[3]=Object.entries(this.associationData[e]).sort((function(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:0})),console.log(this.associationData[e])},deleteAssociation:function(e){var t=this.defaultUserAssociation.find((function(t){return t[0]==e}));delete t[1],t[2]=1/0,delete t[3],this.defaultUserAssociation.sort((function(e,t){return e[2]<t[2]?-1:e[2]>t[2]?1:0}))},changeAssociation:function(e,t){this.defaultUserAssociation.find((function(t){return t[0]==e}))[1]=t.target.value},validateAssociation:function(e){var t=this.defaultUserAssociation.find((function(t){return t[0]==e}));t[2]=0},saveData:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=console,t.next=3,e.$store.state.sqlWorker.send({id:e.$store.state.sqlWorker.id++,action:"exec",sql:"CREATE TABLE IF NOT EXISTS SurveyQuestion (\n            Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n            Question TEXT\n        );"});case 3:return t.t1=t.sent,t.t0.log.call(t.t0,t.t1),t.next=7,e.$store.state.sqlWorker.send({id:e.$store.state.sqlWorker.id++,action:"exec",sql:"CREATE TABLE IF NOT EXISTS UserAnswers (\n            UserId TEXT,\n            QuestionId INTEGER,\n            Answer TEXT,\n            FOREIGN KEY (UserId) REFERENCES Users(Id)\n            FOREIGN KEY(QuestionId) REFERENCES SurveyQuestion(Id),\n            PRIMARY KEY(UserId, QuestionId)\n        );"});case 7:Object.keys(e.originalCSV[0]).forEach((function(t){e.$store.dispatch("addQuestion",{Question:t})})),n=Array.from(e.defaultUserAssociation).filter((function(e){return 0==e[2]})),Array.from(e.originalCSV).forEach((function(t){var r=n.find((function(e){return e[0]==t["2. Nom &amp; Prénom :"]}));if(r){var a=r[1]+e.uptaleEmail;Object.entries(t).forEach((function(t){e.$store.dispatch("addAnswer",{Question:t[0],Answer:t[1],UserId:a})}))}}));case 10:case"end":return t.stop()}}),t)})))()}}};const Lt=Te()(Gt,[["render",At]]);var $t=Lt,_t=function(e){return Object(r["p"])("data-v-cf4fb6ba"),e=e(),Object(r["o"])(),e},Mt={key:0},Wt=_t((function(){return Object(r["h"])("div",null,"U",-1)})),Pt=_t((function(){return Object(r["h"])("div",null,"A",-1)})),Ft=[Wt,Pt],Vt={key:1},Ht=Object(r["i"])("Catergories Setup"),qt=Object(r["i"])("Users Setup"),Qt=Object(r["i"])("SurveyLink"),zt=Object(r["i"])("Analysis"),Jt=Object(r["i"])("SQL Playground"),Bt=_t((function(){return Object(r["h"])("i",{class:"fas fa-angle-double-left"},null,-1)})),Yt=[Bt];function Kt(e,t,n,a,s,c){var o=Object(r["u"])("SidebarLink");return Object(r["n"])(),Object(r["g"])("div",{class:"sidebar",style:Object(r["m"])({width:a.sidebarWidth})},[Object(r["h"])("h1",null,[a.collapsed?(Object(r["n"])(),Object(r["g"])("span",Mt,Ft)):(Object(r["n"])(),Object(r["g"])("span",Vt,"Uptale Analysis"))]),Object(r["j"])(o,{onSidebar_click:t[0]||(t[0]=function(t){return e.$emit("sidebar_click","categories")}),icon:"fas fa-edit"},{default:Object(r["x"])((function(){return[Ht]})),_:1}),Object(r["j"])(o,{onSidebar_click:t[1]||(t[1]=function(t){return e.$emit("sidebar_click","Users")}),icon:"fas fa-edit"},{default:Object(r["x"])((function(){return[qt]})),_:1}),Object(r["j"])(o,{onSidebar_click:t[2]||(t[2]=function(t){return e.$emit("sidebar_click","SurveyLink")}),icon:"fas fa-file-csv"},{default:Object(r["x"])((function(){return[Qt]})),_:1}),Object(r["j"])(o,{onSidebar_click:t[3]||(t[3]=function(t){return e.$emit("sidebar_click","Analysis")}),icon:"fas fa-file-csv"},{default:Object(r["x"])((function(){return[zt]})),_:1}),Object(r["j"])(o,{onSidebar_click:t[4]||(t[4]=function(t){return e.$emit("sidebar_click","SQL")}),icon:"fas fa-database"},{default:Object(r["x"])((function(){return[Jt]})),_:1}),Object(r["h"])("span",{class:Object(r["l"])(["collapse-icon",{"rotate-180":a.collapsed}]),onClick:t[5]||(t[5]=function(){return a.toggleSidebar&&a.toggleSidebar.apply(a,arguments)})},Yt,2)],4)}var Xt={key:0};function Zt(e,t,n,a,s,c){return Object(r["n"])(),Object(r["g"])("div",{class:"sidebarlink",onClick:t[0]||(t[0]=function(t){return e.$emit("sidebar_click")})},[Object(r["h"])("i",{class:Object(r["l"])(["icon",n.icon])},null,2),Object(r["j"])(r["b"],{name:"fade"},{default:Object(r["x"])((function(){return[a.collapsed?Object(r["f"])("",!0):(Object(r["n"])(),Object(r["g"])("span",Xt,[Object(r["t"])(e.$slots,"default",{},void 0,!0)]))]})),_:3})])}var en=Object(r["r"])(!1),tn=function(){return en.value=!en.value},nn=180,rn=38,an=Object(r["c"])((function(){return"".concat(en.value?rn:nn,"px")})),sn={emits:["sidebar_click"],props:{icon:{type:String,required:!0}},setup:function(e){return{collapsed:en}}};n("ddfd");const cn=Te()(sn,[["render",Zt],["__scopeId","data-v-20a26c90"]]);var on=cn,un={emits:["sidebar_click"],props:{},components:{SidebarLink:on},setup:function(){return{collapsed:en,toggleSidebar:tn,sidebarWidth:an}}};n("0a4b"),n("1af0");const dn=Te()(un,[["render",Kt],["__scopeId","data-v-cf4fb6ba"]]);var ln=dn,pn=["value"],fn={key:1,id:"progressMessage"};function bn(e,t,n,a,s,c){var o=Object(r["u"])("FileLoader");return Object(r["n"])(),Object(r["g"])("header",null,[c.progress.progress>0&&c.progress.progress<100?(Object(r["n"])(),Object(r["g"])("progress",{key:0,id:"progress",max:"100",value:c.progress.progress},null,8,pn)):Object(r["f"])("",!0),c.progress.progress>0&&c.progress.progress<100?(Object(r["n"])(),Object(r["g"])("pre",fn,Object(r["v"])(c.progress.message),1)):Object(r["f"])("",!0),Object(r["h"])("h1",null,Object(r["v"])(n.title),1),Object(r["j"])(o,{onDownloadDatabase:t[0]||(t[0]=function(t){return e.$emit("downloadDatabase")}),isLoading:c.isLoading,serializedDatabase:n.serializedDatabase},null,8,["isLoading","serializedDatabase"])])}var hn=function(e){return Object(r["p"])("data-v-6fd185d2"),e=e(),Object(r["o"])(),e},mn={id:"accessButtons"},On=hn((function(){return Object(r["h"])("i",{class:"fas fa-download icon"},null,-1)})),gn=[On];function jn(e,t,n,a,s,c){var o=Object(r["u"])("Prompt");return Object(r["n"])(),Object(r["g"])(r["a"],null,[Object(r["h"])("div",mn,[Object(r["h"])("span",{onClick:t[0]||(t[0]=function(){return c.getSerializedDatabase&&c.getSerializedDatabase.apply(c,arguments)})},gn)]),s.fields[0].file||s.fields[1].file?Object(r["f"])("",!0):(Object(r["n"])(),Object(r["e"])(o,{key:0,data:s.fields,onFileChange:c.fileChange,onCurrentWindowChange:t[1]||(t[1]=function(e){return s.currentWindow=e}),type:"largePanels"},null,8,["data","onFileChange"]))],64)}n("a9e3"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("b680");var vn={class:"prompt"},yn={key:0,id:"content"},In=["for"],kn=["id","name","accept"],Sn={key:1,id:"list"},Un=["href"];function En(e,t,n,a,s,c){return Object(r["n"])(),Object(r["g"])("div",vn,[Object(r["h"])("div",{id:"background",onClick:t[0]||(t[0]=function(t){return e.$emit("currentWindowChange",null)})}),"largePanels"==n.type?(Object(r["n"])(),Object(r["g"])("div",yn,[(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(n.data,(function(n){var a;return Object(r["n"])(),Object(r["g"])("div",{key:n.name,onClick:t[2]||(t[2]=function(){return c.uploadFile&&c.uploadFile.apply(c,arguments)})},[Object(r["h"])("label",{for:n.name},Object(r["v"])(n.label),9,In),Object(r["h"])("input",{type:"file",id:n.name,name:n.name,accept:"."+n.format,onChange:t[1]||(t[1]=function(t){return e.$emit("fileChange",t)})},null,40,kn),Object(r["h"])("i",null,Object(r["v"])(n.file?n.file.name+" "+((null===(a=n.file)||void 0===a?void 0:a.size)/1e6).toFixed(2)+"MB":""),1)])})),128))])):Object(r["f"])("",!0),"propList"==n.type?(Object(r["n"])(),Object(r["g"])("div",Sn,[(Object(r["n"])(!0),Object(r["g"])(r["a"],null,Object(r["s"])(n.data,(function(n,a){return Object(r["n"])(),Object(r["g"])("div",{key:n.Scene,onClick:t[3]||(t[3]=function(){return e.downloadFile&&e.downloadFile.apply(e,arguments)})},[Object(r["h"])("a",{href:"data:text/csv;charset=utf-8,"+encodeURIComponent(c.csvFormat(n))},Object(r["v"])(a),9,Un),Object(r["i"])(" "+Object(r["v"])("".concat(Object.keys(n).length," Utilisateurs")),1)])})),128))])):Object(r["f"])("",!0)])}var wn=n("898b"),Nn={name:"Prompt",emits:["fileChange","currentWindowChange"],components:{},data:function(){return{}},props:{data:Object,type:String},created:function(){},methods:{uploadFile:function(e){"DIV"==e.target.tagName&&e.target.querySelector("input").click()},csvFormat:function(e){return wn["a"](Object.values(e))}}};n("4905");const Cn=Te()(Nn,[["render",En],["__scopeId","data-v-09cc5462"]]);var Tn=Cn,Dn={name:"FileLoader",components:{Prompt:Tn},data:function(){return{currentWindow:"",isLoadingSerializedDatabase:0,fields:[{name:"detail",label:"Select detail data file file here",defaultPath:"/detail.csv",format:"csv"},{name:"database",label:"Select database file here",defaultPath:"/database.db",format:"db"}]}},props:{isLoading:Number,perUserAnswers:Object,serializedDatabase:[]},emits:["updateSerializedDatabase","downloadDatabase"],created:function(){},methods:{load_file:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsText(e)}))},e.prev=1,e.next=4,n(t);case 4:a=e.sent,r=d3.csvParse(a,d3.autoType),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0);case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}(),startAnalysis:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=[],n={},this.fields[0].file&&t.push(this.load_file(this.fields[0].file)),!this.fields[1].file){e.next=11;break}return e.t0=Uint8Array,e.next=7,this.fields[1].file.arrayBuffer();case 7:e.t1=e.sent,n.database=new e.t0(e.t1),e.next=24;break;case 11:return e.next=13,fetch("./database.db");case 13:return e.next=15,e.sent.blob();case 15:if(e.t2=e.sent.type,"application/x-sql; charset=utf-8"!=e.t2){e.next=24;break}return e.t3=Uint8Array,e.next=20,fetch("./database.db");case 20:return e.next=22,e.sent.arrayBuffer();case 22:e.t4=e.sent,n.database=new e.t3(e.t4);case 24:return e.next=26,Promise.all(t);case 26:r=e.sent,n[this.fields[0].name]=r[0],this.$store.dispatch("computeData",n);case 29:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),fileChange:function(e){this.fields.find((function(t){return t.name==e.target.id})).file=e.target.files[0],console.log(this.fields),this.startAnalysis()},mapToArray:function(e){return Ve(e)},getSerializedDatabase:function(){this.isLoadingSerializedDatabase=1,this.$emit("downloadDatabase")}}};n("eb7b");const Rn=Te()(Dn,[["render",jn],["__scopeId","data-v-6fd185d2"]]);var An=Rn,xn={name:"Header",components:{FileLoader:An},emits:["filesLoaded","updateSerializedDatabase","downloadDatabase"],computed:{isLoading:function(){return this.$store.state.IsLoading},progress:function(){return this.$store.state.progress}},props:{serializedDatabase:[],title:{type:String,default:"[Insert Title here]"},perUserAnswers:Object},methods:{filesLoaded:function(e){this.$emit("filesLoaded",e)}}};n("1603");const Gn=Te()(xn,[["render",bn],["__scopeId","data-v-43ba0926"]]);var Ln=Gn,$n={name:"App",components:{Header:Ln,SceneList:_e,Sidebar:ln,Analysis:ct,SQLPlayground:Xe,UsersSetup:It,SurveyLink:$t},data:function(){return{title:"VR@COVID Paths Analysis",computeWorker:Worker,serializedDatabase:"",serializedDatabaseURL:"",display:"SQL",sqlDebugData:{columns:[],values:[]}}},setup:function(){return{sidebarWidth:an}},methods:{sidebarManager:function(e){this.display=e},sceneUpdate:function(e){this.scenes.set(e.id,e),this.updateAndComputePaths()},getSerializedDatabase:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.state.sqlWorker.send({id:e.$store.state.sqlWorker.id,action:"export"});case 2:return n=t.sent.results,e.$store.commit("incrementWorkerId"),t.abrupt("return",new Blob([n],{type:"application/octet-stream"}));case 5:case"end":return t.stop()}}),t)})))()},downloadDatabase:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=1,t.next=3,e.getSerializedDatabase();case 3:e.serializedDatabase=t.sent,URL.revokeObjectURL(e.serializedDatabaseURL),e.serializedDatabaseURL=URL.createObjectURL(e.serializedDatabase),e.loading=0,download.setAttribute("href",e.serializedDatabaseURL),download.click();case 9:case"end":return t.stop()}}),t)})))()}}};n("8f9b");const _n=Te()($n,[["render",le]]);var Mn=_n,Wn=(n("7051"),Object(r["d"])(Mn));Wn.use(ae),Wn.mount("#app")},"7e5e":function(e,t,n){},8177:function(e,t,n){},"88ee":function(e,t,n){},"8a3c":function(e,t,n){"use strict";n("0d8c")},"8f9b":function(e,t,n){"use strict";n("bec1")},"906c":function(e,t,n){"use strict";n("e9e0")},"93a8":function(e,t,n){"use strict";n("9f74")},"9f74":function(e,t,n){},a700:function(e,t,n){},a869:function(e,t,n){"use strict";n("8177")},b869:function(e,t,n){"use strict";n("7e5e")},bcac:function(e,t,n){},bec1:function(e,t,n){},c4dd:function(e,t,n){"use strict";n("f86b")},cf32:function(e,t,n){},dc8a:function(e,t,n){"use strict";n("148d")},ddfd:function(e,t,n){"use strict";n("3ad7")},e9e0:function(e,t,n){},eb7b:function(e,t,n){"use strict";n("06b0")},eba0:function(e,t,n){"use strict";n("cf32")},ebe2:function(e,t,n){},f86b:function(e,t,n){}});
//# sourceMappingURL=app.d4254c01.js.map